<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LikeDokan</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"> </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* ‡¶´‡¶®‡ßç‡¶ü ‡¶ì ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶ó‡ßç‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶® */
        body {
    font-family: 'Hind Siliguri', Inter, sans-serif;
    background-color: #f7f9fc;
    min-height: 100vh;
}

        /* ‡¶¨‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶ï‡¶æ‡¶≤‡¶æ‡¶∞ - ‡¶Ü‡¶ß‡ßÅ‡¶®‡¶ø‡¶ï ‡¶®‡ßÄ‡¶≤ */
        .brand-blue {
            background-color: #0d6efd; /* ‡¶¨‡ßÅ‡¶ü‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶™ ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞‡¶ø ‡¶¨‡ßç‡¶≤‡ßÅ ‡¶è‡¶∞ ‡¶ï‡¶æ‡¶õ‡¶æ‡¶ï‡¶æ‡¶õ‡¶ø */
            transition: background-color 0.2s;
        }

        .brand-blue:hover {
            background-color: #0b5ed7;
        }

        .brand-blue-text {
            color: #0d6efd;
        }

        /* ‡¶ï‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ - ‡¶è‡¶≤‡¶ø‡¶≠‡ßá‡¶ü‡ßá‡¶° ‡¶≤‡ßÅ‡¶ï */
        .app-card {
            background: white;
            border-radius: 12px; /* ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶°‡ßá‡¶° */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); /* ‡¶π‡¶æ‡¶≤‡¶ï‡¶æ ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø‡¶Æ‡¶æ‡¶® ‡¶∂‡ßç‡¶Ø‡¶æ‡¶°‡ßã */
            border: 1px solid #e9ecef;
            transition: box-shadow 0.3s, transform 0.2s;
        }

        .app-card:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            transform: translateY(-1px);
        }

        /* ‡¶´‡¶ø‡¶ï‡ßç‡¶∏‡¶° ‡¶π‡ßá‡¶°‡¶æ‡¶∞ */
        .fixed-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 50;
            background: white;
            border-bottom: 1px solid #e9ecef;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        /* ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßç‡¶Ø‡¶æ‡¶°‡¶ø‡¶Ç */
        .content-margin{
            margin-top: 6rem;
        }

        /* ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤‡¶ø‡¶Ç */
        .app-input {
            border: 1px solid #ced4da;
            border-radius: 8px;
            padding: 12px;
            font-size: 16px;
            background-color: white;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .app-input:focus {
            outline: none;
            border-color: #0d6efd;
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
        }

        /* ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶∏‡ßç‡¶™‡¶ø‡¶®‡¶æ‡¶∞ ‡¶ì ‡¶ì‡¶≠‡¶æ‡¶∞‡¶≤‡ßá ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ (‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§) */
        #loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
            gap: 1rem;
            color: #333;
            font-size: 1.25rem;
            font-weight: 600;
            opacity: 1; /* ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü‡¶∞‡ßÇ‡¶™‡ßá ‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø‡¶Æ‡¶æ‡¶® */
            pointer-events: all; /* ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶® ‡¶¨‡ßç‡¶≤‡¶ï ‡¶ï‡¶∞‡¶æ */
            transition: opacity 0.5s ease-out; /* ‡¶Æ‡¶∏‡ßÉ‡¶£ ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡¶ú‡¶ø‡¶∂‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã */
        }
        
        /* ‡¶ì‡¶≠‡¶æ‡¶∞‡¶≤‡ßá ‡¶Ö‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ */
        #loading-overlay.fade-out {
            opacity: 0;
            pointer-events: none; /* ‡¶Ö‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶® ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ */
        }

        .spinner {
            border: 4px solid #e5e7eb;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-top-color: #0d6efd;
            animation: spin 1s ease infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* --- ‡¶õ‡ßã‡¶ü ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ (‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ï‡¶æ‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø) --- */
        .small-rating-bar {
            display: flex;
            align-items: center;
            gap: 2px;
        }
        .small-star {
            font-size: 0.75rem; /* ‡¶õ‡ßã‡¶ü ‡¶Ü‡¶ï‡¶æ‡¶∞ */
        }
        .filled-star {
            color: #ffc107; /* ‡¶∏‡ßã‡¶®‡¶æ‡¶≤‡ßÄ ‡¶∞‡¶Ç */
        }

        .empty-star {
            color: #e9ecef; /* ‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶§‡¶æ‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶π‡¶æ‡¶≤‡¶ï‡¶æ ‡¶ß‡ßÇ‡¶∏‡¶∞ */
        }
        
        .small-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background-color: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4b5563;
            font-size: 0.7rem;
            font-weight: bold;
            overflow: hidden;
            flex-shrink: 0; /* ‡¶õ‡ßã‡¶ü ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡ßá ‡¶∏‡¶ô‡ßç‡¶ï‡ßÅ‡¶ö‡¶ø‡¶§ ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ü‡¶ü‡¶ï‡¶æ‡¶¨‡ßá */
        }
        .small-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        /* --- ‡¶õ‡ßã‡¶ü ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ ‡¶∂‡ßá‡¶∑ --- */
    </style>
</head>
<body>
    
    <!-- ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶ì‡¶≠‡¶æ‡¶∞‡¶≤‡ßá -->
    <div id="loading-overlay">
        <div class="spinner"></div>
        <p>‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
    </div>

    <!-- ‡¶π‡ßá‡¶°‡¶æ‡¶∞ -->
    <header class="fixed-header">
        <div class="container max-w-6xl mx-auto px-4 py-3 flex justify-between items-center h-16">
            
            <!-- ‡¶≤‡ßã‡¶ó‡ßã ‡¶è‡¶¨‡¶Ç ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤ -->
            <div class="text-xl font-extrabold brand-blue-text flex items-center">
                <span class="mr-2 text-3xl"></span> Like Dokan
            </div>
            
            <!-- ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ú ‡¶ì ‡¶®‡ßá‡¶≠‡¶ø‡¶ó‡ßá‡¶∂‡¶® -->
            <div class="flex items-center gap-0">
                <!-- text-0.1 ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßá text-sm ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã -->
                <div class="bg-gradient-to-r from-blue-300 to-blue-600 text-white font-bold px-3 py-0.5 rounded-full text-sm flex items-center shadow-md">
                    <i class="fas fa-coins mr-2"></i>
                    <span id="user-points">0</span>
                </div>
                
                <!-- ‡¶®‡ßá‡¶≠‡¶ø‡¶ó‡ßá‡¶∂‡¶® ‡¶¨‡¶æ‡¶ü‡¶® -->
                <button class="w-10 h-10 rounded-full hover:bg-gray-100 transition duration-200 text-gray-600" title="‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤" onclick="window.location.href='profile.html'">
                    <i class="fas fa-user text-lg"></i>
                </button>
                <button class="w-10 h-10 rounded-full hover:bg-gray-100 transition duration-200 text-gray-600" title="‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü" onclick="window.logout()">
                    <i class="fas fa-sign-out-alt text-lg"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- ‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü -->
    <div class="container max-w-4xl mx-auto px-4 content-margin hidden" id="main-content-container">
        
        <main>
            <!-- ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶® ‡¶ï‡¶æ‡¶∞‡ßç‡¶° (Quick Actions Card) -->
            <div class="app-card p-6 mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center border-b pb-4">
                    ‚öôÔ∏è ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®
                </h2>
                <!-- ‡¶®‡¶§‡ßÅ‡¶®: ‡¶ó‡ßç‡¶∞‡¶ø‡¶° ‡ß®x‡ß® (‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤) ‡¶è‡¶¨‡¶Ç ‡ß™x‡ßß (‡¶°‡ßá‡¶∏‡ßç‡¶ï‡¶ü‡¶™) -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <a href="order.html" class="block brand-blue text-center py-3 px-2 text-xs md:text-sm font-bold rounded-xl text-white hover:shadow-xl hover:brightness-110 transform transition duration-300 shadow-md">
                        <i class="fas fa-plus-circle block md:hidden mb-1"></i> 
                        <span class="hidden md:inline"><i class="fas fa-plus-circle mr-1"></i></span> ‡¶®‡¶§‡ßÅ‡¶® ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞
                    </a>
                    <a href="profile.html" class="block bg-gray-500 text-center py-3 px-2 text-xs md:text-sm font-bold rounded-xl text-white hover:bg-gray-600 hover:shadow-xl transform transition duration-300 shadow-md">
                         <i class="fas fa-user block md:hidden mb-1"></i>
                         <span class="hidden md:inline"><i class="fas fa-user mr-1"></i></span> ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤
                    </a>
                    <a href="leaderboard.html" class="block bg-yellow-500 text-center py-3 px-2 text-xs md:text-sm font-bold rounded-xl text-white hover:bg-yellow-600 hover:shadow-xl transform transition duration-300 shadow-md">
                         <i class="fas fa-crown block md:hidden mb-1"></i>
                         <span class="hidden md:inline"><i class="fas fa-crown mr-1"></i></span> ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°
                    </a>
                    <a href="referral.html" class="block bg-purple-500 text-center py-3 px-2 text-xs md:text-sm font-bold rounded-xl text-white hover:bg-purple-600 hover:shadow-xl transform transition duration-300 shadow-md">
                         <i class="fas fa-handshake block md:hidden mb-1"></i>
                         <span class="hidden md:inline"><i class="fas fa-handshake mr-1"></i></span> ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤
                    </a>
                </div>
            </div>
            
            <!-- Admin/Moderator Links (Hidden by default) -->
            <div class="app-card p-6 mb-8 hidden" id="admin-mod-links-section">
                <h2 class="text-xl font-bold text-gray-800 mb-6 text-center border-b pb-4">
                    üîê ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <a href="admin.html" id="admin-link" class="block bg-indigo-600 text-center py-3 px-4 text-sm font-bold rounded-xl text-white hover:bg-indigo-700 hover:shadow-xl transform transition duration-300 shadow-md hidden">
                        <i class="fas fa-tools mr-1"></i> ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°
                    </a>
                    <a href="moderator.html" id="moderator-link" class="block bg-pink-600 text-center py-3 px-4 text-sm font-bold rounded-xl text-white hover:bg-pink-700 hover:shadow-xl transform transition duration-300 shadow-md hidden">
                        <i class="fas fa-user-shield mr-1"></i> ‡¶Æ‡¶°‡¶æ‡¶∞‡ßá‡¶ü‡¶∞ ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤
                    </a>
                </div>
            </div>

            <!-- ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶ì ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶° -->
            <div class="app-card p-6 mb-8" id="dashboard">
                
                <!-- ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡ßá‡¶ï‡¶∂‡¶® -->
                <div class="flex items-center gap-4 mb-6 pb-6 border-b border-gray-100">
                    <!-- w-20 h-11 ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßá w-20 h-20 ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã -->
                    <div class="w-20 h-20 bg-gray-100 brand-blue-text rounded-full flex items-center justify-center text-3xl font-bold overflow-hidden border-2 border-gray-300" id="profile-avatar">
                        S
                    </div>
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800" id="user-name-display">‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ</h3>
                        <p class="text-gray-500 text-sm mt-1">
                            ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø: <span id="user-id-display" class="font-mono text-xs bg-gray-100 px-2 py-0.5 rounded">user123</span>
                        </p>
                    </div>
                </div>

                <!-- ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶® -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    
                    <div class="stat-card p-4 text-center bg-yellow-50 rounded-lg shadow-sm">
                        <i class="fas fa-star text-3xl text-yellow-500 mb-2"></i>
                        <div class="text-2xl font-bold text-gray-800" id="total-points">‡ß¶</div>
                        <div class="text-sm text-gray-500">‡¶Æ‡ßã‡¶ü ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü</div>
                    </div>
                    
                    <div class="stat-card p-4 text-center bg-blue-50 rounded-lg shadow-sm">
                        <i class="fas fa-chart-line text-3xl brand-blue-text mb-2"></i>
                        <div class="text-2xl font-bold text-gray-800" id="total-tasks-created">‡ß¶</div>
                        <div class="text-sm text-gray-500">‡¶§‡ßà‡¶∞‡¶ø‡¶ï‡ßÉ‡¶§ ‡¶ï‡¶æ‡¶ú</div>
                    </div>
                    
                    <div class="stat-card p-4 text-center bg-green-50 rounded-lg shadow-sm">
                        <i class="fas fa-check-circle text-3xl text-green-500 mb-2"></i>
                        <div class="text-2xl font-bold text-gray-800" id="total-tasks-completed">‡ß¶</div>
                        <div class="text-sm text-gray-500">‡¶∏‡¶´‡¶≤ ‡¶ï‡¶æ‡¶ú</div>
                    </div>
                    
                    <div class="stat-card p-4 text-center bg-red-50 rounded-lg shadow-sm">
                        <i class="fas fa-times-circle text-3xl text-red-500 mb-2"></i>
                        <div class="text-2xl font-bold text-gray-800" id="total-tasks-rejected">‡ß¶</div>
                        <div class="text-sm text-gray-500">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶æ‡¶ú</div>
                    </div>
                </div>
            </div>

            <!-- ‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï -->
            <div class="app-card p-6 mb-8" id="available-tasks-section">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center border-b pb-4">
                    üéØ ‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßÇ‡¶π
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="available-tasks-grid">
                    <!-- Tasks will be loaded here -->
                </div>
            </div>
            
            <!-- ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ (NEW SECTION) -->
            <div class="app-card p-6 mb-8" id="submitted-proofs-section">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center border-b pb-4">
                    üìù ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏
                </h2>
                <div id="submitted-proofs-list" class="space-y-4">
                    <!-- Proofs will be loaded here -->
                </div>
            </div>
            
            <!-- '‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®‡¶ï‡ßÉ‡¶§ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï' ‡¶∏‡ßá‡¶ï‡¶∂‡¶®‡¶ü‡¶ø ‡¶è‡¶ñ‡¶æ‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶¨‡¶æ‡¶¶ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá -->

        </main>
    </div>

    <!-- ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶® ‡¶Æ‡¶°‡¶æ‡¶≤ (‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§: ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶®‡¶æ‡¶Æ ‡¶ì ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü) -->
    <div id="submit-proof-modal" class="fixed inset-0 z-50 flex justify-center items-center p-4 transition-opacity duration-300 hidden" style="background-color: rgba(0, 0, 0, 0.4);">
        <div class="app-card p-6 w-full max-w-md relative animate-in zoom-in-50 duration-300">
            <button class="absolute top-3 right-3 text-gray-500 hover:text-gray-800 text-3xl transition" onclick="closeModal('submit-proof-modal')">
                &times;
            </button>
            <h2 class="text-xl font-bold text-gray-800 mb-6 border-b pb-3">‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï ‡¶Ü‡¶á‡¶°‡¶ø ‡¶ì ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®</h2>
            <form id="submitProofForm">
                
                <!-- ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï ‡¶Ü‡¶á‡¶°‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ -->
                <div class="mb-4">
                    <label for="facebookName" class="block text-sm font-medium text-gray-700 mb-2">
                        ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï ‡¶Ü‡¶á‡¶°‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ:
                    </label>
                    <!-- autocomplete="off" ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶Ø‡¶æ‡¶§‡ßá ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü ‡¶∏‡¶æ‡¶ú‡ßá‡¶∂‡¶® ‡¶®‡¶æ ‡¶Ü‡¶∏‡ßá -->
                    <input type="text" id="facebookName" name="facebookName" 
                           class="app-input w-full" 
                           placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: Shuvo Ahamed" required autocomplete="off">
                    <p class="text-xs text-gray-500 mt-1">‡¶è‡¶á ‡¶§‡¶•‡ßç‡¶Ø‡¶ü‡¶ø ‡¶∂‡ßá‡¶∑‡¶¨‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßç‡¶¨‡ßü‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡ßü‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã‡•§</p>
                </div>

                <!-- ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü -->
                <div class="mb-6">
                    <label for="screenshotFile" class="block text-sm font-medium text-gray-700 mb-2">
                        ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®:
                    </label>
                    <input type="file" id="screenshotFile" name="screenshotFile" accept="image/*"
                           class="w-full text-sm text-gray-500
                                  file:mr-4 file:py-2 file:px-4
                                  file:rounded-full file:border-0
                                  file:text-sm file:font-semibold
                                  file:bg-blue-50 file:text-blue-700
                                  hover:file:bg-blue-100" required>
                    <p class="text-xs text-gray-500 mt-1">‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ JPG/PNG ‡¶´‡¶æ‡¶á‡¶≤ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø‡•§ (‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶æ‡¶á‡¶ú ‡¶ï‡¶Æ ‡¶∞‡¶æ‡¶ñ‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®)</p>
                </div>
                
                <button type="submit" class="w-full brand-blue text-white py-3 text-center rounded-lg font-bold hover:shadow-lg transition duration-200">
                    <i class="fas fa-upload mr-2"></i> ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®
                </button>
            </form>
        </div>
    </div>
    
    <div id="notification-container" class="fixed bottom-4 right-4 z-50 space-y-2"></div>
    
    <script type="module">
        // Firebase RTDB imports
        import { auth, rtdb, showNotification, logout } from './rtdb-config.js';
        import { onAuthStateChanged, setPersistence, browserSessionPersistence, signInWithCustomToken, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js";
        import { set, ref, onValue, push, update, get } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-database.js";
        
        const loadingOverlay = document.getElementById('loading-overlay');
        const mainContentContainer = document.getElementById('main-content-container');
        const availableTasksGrid = document.getElementById('available-tasks-grid');
        const availableTasksSection = document.getElementById('available-tasks-section');
        
        const submitProofModal = document.getElementById('submit-proof-modal');
        const submitProofForm = document.getElementById('submitProofForm');
        
        let currentTaskId = null;
        let userId = null;
        let currentUserPoints = 0;
        let currentUserName = '';
        let userCompletedTasks = {};
        
        // ‡¶∂‡ßá‡¶∑‡¶¨‡¶æ‡¶∞ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶≠‡ßç‡¶Ø‡¶æ‡¶∞‡¶ø‡ßü‡ßá‡¶¨‡¶≤ (‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶¨‡¶æ‡¶¶ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶≤‡ßã)
        let lastFacebookName = '';
        
        let authAndDataLoaded = false;
        
        // üî• ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶∞‡¶ø‡ßü‡ßá‡¶¨‡¶≤ (‡¶®‡¶æ‡¶Æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã)
        let userProfileCache = {}; 
        
        // ----------------------------------------------------------------------
        // üî• Cloudinary ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶®: ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶Ü‡¶™‡¶≤‡ßã‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
        // ----------------------------------------------------------------------
        const CLOUDINARY_CLOUD_NAME = 'deqeko2ny'; // profile.html ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡ßá‡¶ì‡ßü‡¶æ
        const CLOUDINARY_UPLOAD_PRESET = 'Profilepicture'; // profile.html ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡ßá‡¶ì‡ßü‡¶æ
        const CLOUDINARY_URL = `https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`;
        // ----------------------------------------------------------------------

        /**
         * ‡¶¨‡¶°‡¶º ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶ï‡ßá ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§ ‡¶´‡¶∞‡ßç‡¶Æ‡ßá (K, M, B) ‡¶∞‡ßÇ‡¶™‡¶æ‡¶®‡ßç‡¶§‡¶∞ ‡¶ï‡¶∞‡ßá‡•§
         * @param {number} num - ‡¶Ø‡ßá ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶ü‡¶ø ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá‡•§
         * @returns {string} - ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Ç (‡¶Ø‡ßá‡¶Æ‡¶®: 10000 -> 10k)
         */
        const formatPoints = (num) => {
            // ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶ø ‡¶Ø‡ßá num ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ
            if (typeof num !== 'number' || isNaN(num)) {
                return '0';
            }
            
            // ‡¶ß‡¶®‡¶æ‡¶§‡ßç‡¶Æ‡¶ï ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶ø
            const absNum = Math.abs(num);
            
            if (absNum >= 1000000000) {
                // ‡¶¨‡¶ø‡¶≤‡¶ø‡¶Ø‡¶º‡¶® (B) - 1000,000,000
                return (num / 1000000000).toFixed(1).replace(/\.0$/, '') + 'B';
            }
            if (absNum >= 1000000) {
                // ‡¶Æ‡¶ø‡¶≤‡¶ø‡¶Ø‡¶º‡¶® (M) - 1,000,000
                const formatted = (num / 1000000).toFixed(1);
                // ‡¶Ø‡¶¶‡¶ø .0 ‡¶è ‡¶∂‡ßá‡¶∑ ‡¶π‡¶Ø‡¶º, ‡¶§‡¶¨‡ßá .0 ‡¶¨‡¶æ‡¶¶ ‡¶¶‡ßá‡¶¨‡ßá
                if (formatted.endsWith('.0')) {
                    return formatted.slice(0, -2) + 'M';
                }
                return formatted + 'M';
            }
            if (absNum >= 10000) {
                // ‡¶π‡¶æ‡¶ú‡¶æ‡¶∞ (k) - 10,000 (‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ)
                const formatted = (num / 1000).toFixed(1);
                if (formatted.endsWith('.0')) {
                    return formatted.slice(0, -2) + 'k';
                }
                return formatted + 'k';
            }
            // 10,000 ‡¶è‡¶∞ ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶ï‡ßá ‡¶ï‡¶Æ‡¶æ ‡¶∏‡¶π ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßÄ‡¶Ø‡¶º ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá
            return num.toLocaleString('en');
        };

        const showContentAndHideLoader = () => {
            if (!authAndDataLoaded) {
                authAndDataLoaded = true;
                // 'hidden' ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡ßá 'fade-out' ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                loadingOverlay.classList.add('fade-out');
                mainContentContainer.classList.remove('hidden');
            }
        };

        setTimeout(() => {
            if (!authAndDataLoaded) {
                console.warn("Loading timeout exceeded. Showing content anyway.");
                showNotification('‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶§‡ßá ‡¶¨‡ßá‡¶∂‡¶ø ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶®‡¶ø‡¶ö‡ßç‡¶õ‡ßá, ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶¨‡¶æ ‡¶™‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'warning');
                showContentAndHideLoader();
            }
        }, 5000); 

        window.scrollToTasks = () => {
            if (availableTasksSection) {
                availableTasksSection.scrollIntoView({
                    behavior: 'smooth'
                });
            }
        };

        /**
         * ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡ßá‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ú ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá‡•§
         * @param {string} status - ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡ßá‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ('approved', 'rejected', 'pending')
         * @returns {string} - HTML ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ú ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Ç
         */
        const getStatusBadge = (status) => {
            const baseClasses = "px-3 py-1 text-sm font-medium rounded-full flex items-center shadow-sm";
            let colorClasses;
            let text;
            let icon;
            switch(status) {
                case 'approved':
                    colorClasses = 'bg-green-100 text-green-700';
                    text = '‡¶∏‡¶´‡¶≤';
                    icon = 'fas fa-check-circle';
                    break;
                case 'rejected':
                    colorClasses = 'bg-red-100 text-red-700';
                    text = '‡¶¨‡¶æ‡¶§‡¶ø‡¶≤';
                    icon = 'fas fa-times-circle';
                    break;
                default:
                    colorClasses = 'bg-yellow-100 text-yellow-700';
                    text = '‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶ö‡¶≤‡¶õ‡ßá';
                    icon = 'fas fa-hourglass-half';
            }
            return `<span class="${baseClasses} ${colorClasses}"><i class="${icon} mr-1"></i> ${text}</span>`;
        };
        
        const getTaskTypeBadge = (type) => {
             // ‡¶Ü‡¶ß‡ßÅ‡¶®‡¶ø‡¶ï ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ú ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤
            const baseClasses = "px-3 py-1 text-xs font-medium rounded-full capitalize shadow-sm";
            let colorClasses;
            switch(type.toLowerCase()) {
                case 'like':
                    colorClasses = "bg-blue-500 text-white";
                    break;
                case 'comment':
                    colorClasses = "bg-purple-500 text-white";
                    break;
                case 'share':
                    colorClasses = "bg-pink-500 text-white";
                    break;
                case 'group': // ‡¶®‡¶§‡ßÅ‡¶® ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ü‡¶æ‡¶á‡¶™‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                    colorClasses = "bg-teal-500 text-white";
                    break;
                default:
                    colorClasses = "bg-gray-200 text-gray-800";
            }
            return `<span class="${baseClasses} ${colorClasses}">${type}</span>`;
        }
        
        /**
         * ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º‡¶ï‡ßá ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßÄ‡ßü ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡ßü‡•§
         * @param {number} timestamp - ‡¶Æ‡¶ø‡¶≤‡¶ø‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá ‡¶∏‡¶Æ‡ßü
         * @returns {string} - ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶°‡ßá‡¶ü-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Ç
         */
        const formatDate = (timestamp) => {
            if (!timestamp) return 'N/A';
            const date = new Date(timestamp);
            return date.toLocaleString('bn-BD', { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric', 
                hour: '2-digit', 
                minute: '2-digit' 
            });
        };


        /**
         * ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∞‡ßã‡¶≤‡ßá‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø ‡¶ï‡¶∞‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶®/‡¶Æ‡¶°‡¶æ‡¶∞‡ßá‡¶ü‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø‡¶Æ‡¶æ‡¶®‡¶§‡¶æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßá‡•§
         * @param {string} role - ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∞‡ßã‡¶≤ ('user', 'moderator', 'admin')
         */
        const updateDashboardLinks = (role) => {
            const adminModSection = document.getElementById('admin-mod-links-section');
            const adminLink = document.getElementById('admin-link');
            const moderatorLink = document.getElementById('moderator-link');
            
            if (role === 'admin') {
                adminModSection.classList.remove('hidden');
                adminLink.classList.remove('hidden');
                moderatorLink.classList.remove('hidden');
            } else if (role === 'moderator') {
                adminModSection.classList.remove('hidden');
                adminLink.classList.add('hidden');
                moderatorLink.classList.remove('hidden');
            } else {
                adminModSection.classList.add('hidden');
                adminLink.classList.add('hidden');
                moderatorLink.classList.add('hidden');
            }
        };

        // üî• ‡¶®‡¶§‡ßÅ‡¶®: ‡¶∏‡¶´‡¶≤ ‡¶ì ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø ‡¶ï‡¶∞‡ßá ‡ß´-‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶ó‡¶£‡¶®‡¶æ ‡¶ï‡¶∞‡ßá
        const calculateRating = (completed, rejected) => {
            const total = completed + rejected;
            if (total === 0) {
                return 3.0; // ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç
            }
            const successRate = completed / total;
            const rating = parseFloat((5 * successRate).toFixed(1));
            return rating;
        };

        // üî• ‡¶®‡¶§‡ßÅ‡¶®: ‡¶õ‡ßã‡¶ü ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá
        const renderSmallStarRating = (score) => {
            const roundedScore = Math.round(score * 2) / 2; 
            let html = '';
            for (let i = 1; i <= 5; i++) {
                if (roundedScore >= i) {
                    html += `<i class="fas fa-star small-star filled-star"></i>`;
                } else if (roundedScore === i - 0.5) {
                    html += `<i class="fas fa-star-half-alt small-star filled-star"></i>`;
                } else {
                    html += `<i class="far fa-star small-star filled-star empty-star"></i>`;
                }
            }
            // ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá, ‡¶§‡¶æ‡¶á ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶ü‡¶æ‡¶∞‡ßç‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
            return html;
        };
        
        // ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≠‡¶æ‡¶ü‡¶æ‡¶∞ HTML ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        const getOwnerInfoHtml = (ownerId) => {
            const profile = userProfileCache[ownerId] || {};
            const name = profile.facebookName || '‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞';
            const photoUrl = profile.profilePhotoUrl;
            const completed = profile.tasksCompleted || 0;
            const rejected = profile.tasksRejected || 0;
            
            const ratingScore = calculateRating(completed, rejected);
            const ratingHtml = renderSmallStarRating(ratingScore);
            
            const initial = name.charAt(0).toUpperCase();
            
            // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≠‡¶æ‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞
            let avatarHtml;
            if (photoUrl) {
                avatarHtml = `<img src="${photoUrl}" alt="${name}" class="w-full h-full object-cover">`;
            } else {
                // ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≠‡¶æ‡¶ü‡¶æ‡¶∞ (‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞)
                avatarHtml = `<span class="text-xs">${initial}</span>`;
            }
            
            return `
                <div class="flex items-center space-x-2">
                    <div class="small-avatar">
                        ${avatarHtml}
                    </div>
                    <div>
                        <span class="text-sm font-semibold text-gray-800">${name}</span>
                        <!-- ‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶æ‡¶∏‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø‡¶§‡¶æ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶¨‡¶æ‡¶∞ -->
                        <div class="small-rating-bar">
                            ${ratingHtml}
                            <span class="text-xs text-gray-500 ml-1">(${ratingScore.toFixed(1)})</span>
                        </div>
                    </div>
                </div>
            `;
        };
        
        // üî• ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (‡¶Ü‡¶ó‡ßá‡¶∞‡¶ü‡¶ø‡¶∞ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü)
        const cacheUserProfiles = async (userIds) => {
            const usersToFetch = Array.from(userIds).filter(id => id && !userProfileCache[id]);

            for (const id of usersToFetch) {
                try {
                    const snapshot = await get(ref(rtdb, `users/${id}`));
                    const userData = snapshot.val();
                    if (userData) {
                        // ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡ßá‡¶ü‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá
                        userProfileCache[id] = {
                            facebookName: userData.facebookName || '‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ',
                            profilePhotoUrl: userData.profilePhotoUrl || null,
                            tasksCompleted: userData.tasksCompleted || 0,
                            tasksRejected: userData.tasksRejected || 0,
                            role: userData.role || 'user'
                        };
                    } else {
                        userProfileCache[id] = {
                            facebookName: `‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ${id.substring(0, 4)}...`,
                            profilePhotoUrl: null,
                            tasksCompleted: 0,
                            tasksRejected: 0,
                            role: 'user'
                        };
                    }
                } catch (error) {
                    console.error(`Error fetching user ${id}:`, error);
                    userProfileCache[id] = {
                         facebookName: `‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ${id.substring(0, 4)}... (‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø)`,
                         profilePhotoUrl: null,
                         tasksCompleted: 0,
                         tasksRejected: 0,
                         role: 'user'
                    };
                }
            }
        };

        // Cloudinary ‡¶§‡ßá ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶°‡ßá‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (profile.html ‡¶•‡ßá‡¶ï‡ßá ‡¶Ü‡¶®‡¶æ)
        async function uploadToCloudinary(file) {
            if (!file) return null;

            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);
            // ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ ‡¶´‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
            formData.append('folder', `task_proofs/${userId}`); 

            try {
                showNotification("‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", 'info');
                const response = await fetch(CLOUDINARY_URL, {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error("Cloudinary Error:", errorData);
                    throw new Error(`Cloudinary ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•: ${errorData.error.message || response.statusText}`);
                }

                const data = await response.json();
                showNotification("‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!", 'success');
                return data.secure_url; // ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶õ‡¶¨‡¶ø‡¶∞ URL
            } catch (error) {
                console.error("Error during Cloudinary upload:", error);
                showNotification(`‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§`, 'error');
                throw error; 
            }
        }

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                userId = user.uid;
                
                const userRef = ref(rtdb, `users/${userId}`);
                onValue(userRef, async (snapshot) => {
                    const userData = snapshot.val() || {};

                    if (snapshot.val() === null) {
                        const initialUserData = {
                            points: 0,
                            facebookName: '‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ',
                            tasksCreated: 0,
                            tasksCompleted: 0,
                            tasksRejected: 0,
                            createdAt: Date.now(),
                            // ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡ßü‡¶æ‡¶≤‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶®‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                            lastFacebookName: '',
                            role: 'user' // ‡¶®‡¶§‡ßÅ‡¶®: ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü ‡¶∞‡ßã‡¶≤ ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                        };
                        try {
                            // ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡ßü‡¶æ‡¶≤‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶®‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßü lastFacebookLink ‡¶ï‡ßá ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡¶≤‡ßã
                            // ‡¶§‡¶¨‡ßá ‡¶è‡¶á ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶®‡ßá ‡¶è‡¶ü‡¶ø ‡¶Ü‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá ‡¶®‡¶æ‡•§
                            await set(userRef, initialUserData);
                            return; 
                        } catch (e) {
                            console.error("User initialization failed:", e);
                            showNotification('‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶°‡ßá‡¶ü‡¶æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá‡•§', 'error');
                        }
                    }

                    currentUserPoints = userData.points || 0; 
                    currentUserName = userData.facebookName || '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ';
                    userCompletedTasks = userData.completedTasks || {};
                    
                    // ‡¶∂‡ßá‡¶∑‡¶¨‡¶æ‡¶∞ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá (‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶¨‡¶æ‡¶¶ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶≤‡ßã)
                    lastFacebookName = userData.lastFacebookName || '';
                    
                    const userRole = userData.role || 'user'; // ‡¶®‡¶§‡ßÅ‡¶®: ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∞‡ßã‡¶≤ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                    updateDashboardLinks(userRole); // ‡¶®‡¶§‡ßÅ‡¶®: ‡¶∞‡ßã‡¶≤‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                    
                    // ‡¶è‡¶ñ‡¶æ‡¶®‡ßá formatPoints ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá
                    document.getElementById('user-points').textContent = formatPoints(currentUserPoints);
                    document.getElementById('total-points').textContent = formatPoints(currentUserPoints);
                    document.getElementById('total-tasks-created').textContent = formatPoints(userData.tasksCreated || 0);
                    document.getElementById('total-tasks-completed').textContent = formatPoints(userData.tasksCompleted || 0);
                    document.getElementById('total-tasks-rejected').textContent = formatPoints(userData.tasksRejected || 0);
                    document.getElementById('user-name-display').textContent = currentUserName;
                    document.getElementById('user-id-display').textContent = user.uid;
                    
                    const profileAvatar = document.getElementById('profile-avatar');
                    profileAvatar.innerHTML = '';
                    if (userData.profilePhotoUrl) {
                        const img = document.createElement('img');
                        img.src = userData.profilePhotoUrl;
                        img.alt = userData.facebookName || '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ';
                        img.className = 'w-full h-full object-cover rounded-full';
                        profileAvatar.appendChild(img);
                    } else if (userData.facebookName) {
                        profileAvatar.textContent = userData.facebookName.charAt(0).toUpperCase();
                    }
                    
                    listenForTasks(); 
                    showContentAndHideLoader();
                });
                
            } else {
                try {
                    await setPersistence(auth, browserSessionPersistence);
                    const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                    if (initialAuthToken) {
                        await signInWithCustomToken(auth, initialAuthToken);
                    } else {
                        await signInAnonymously(auth);
                    }
                } catch (error) {
                    console.error("Authentication failed:", error);
                    showNotification('‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá‡•§ ‡¶™‡ßá‡¶ú‡¶ü‡¶ø ‡¶∞‡¶ø‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
                    showContentAndHideLoader();
                }
            }
        });
        
        /**
         * ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶™‡ßç‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡¶® ‡¶ï‡¶∞‡ßá‡•§
         * @param {Array<Object>} proofs - ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ‡•§
         */
        const displaySubmittedProofs = (proofs) => {
            const submittedProofsList = document.getElementById('submitted-proofs-list');
            submittedProofsList.innerHTML = ''; // ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶™‡¶∞‡¶ø‡¶∑‡ßç‡¶ï‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ

            if (proofs.length === 0) {
                submittedProofsList.innerHTML = '<div class="text-center py-6 text-gray-500">‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶®‡¶®‡¶ø‡•§</div>';
                return;
            }

            proofs.forEach(proof => {
                // üî• ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶≤‡ßã
                const reviewerProfile = userProfileCache[proof.reviewedBy];
                const reviewerDisplayName = reviewerProfile 
                    ? (reviewerProfile.facebookName || '‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ') + (reviewerProfile.role === 'admin' ? ' (‡¶è‡¶°‡¶Æ‡¶ø‡¶®)' : reviewerProfile.role === 'moderator' ? ' (‡¶Æ‡¶°‡¶æ‡¶∞‡ßá‡¶ü‡¶∞)' : '')
                    : (proof.reviewedBy ? `ID: ${proof.reviewedBy.substring(0, 8)}...` : '‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶õ‡ßá');
                
                const card = `
                    <div class="app-card p-5 border-l-4 ${proof.status === 'approved' ? 'border-green-500' : (proof.status === 'rejected' ? 'border-red-500' : 'border-yellow-500')}">
                        
                        <!-- ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ü‡¶æ‡¶á‡¶™, ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶ì ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ -->
                        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 pb-3 border-b border-gray-100">
                            <div class="flex items-center space-x-2 mb-2 sm:mb-0">
                                ${getTaskTypeBadge(proof.taskType)}
                                <span class="text-lg font-bold text-gray-800">
                                    +${formatPoints(proof.pointsPerTask)} ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü
                                </span>
                            </div>
                            <!-- ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ú -->
                            ${getStatusBadge(proof.status)}
                        </div>
                        
                        <div class="space-y-2 text-sm text-gray-600">
                            <!-- ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶≤‡¶ø‡¶Ç‡¶ï -->
                            <p class="flex items-start">
                                <i class="fas fa-link text-blue-500 mr-2 mt-1"></i>
                                <span>
                                    <span class="font-medium text-gray-500 block">‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶≤‡¶ø‡¶Ç‡¶ï:</span>
                                    <a href="${proof.taskLink}" target="_blank" class="brand-blue-text hover:underline break-all">${proof.taskLink}</a>
                                </span>
                            </p>
                            <!-- ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶Ü‡¶á‡¶°‡¶ø -->
                            <p class="flex items-center">
                                <i class="fas fa-user-circle text-gray-500 mr-2"></i>
                                <span>
                                    <span class="font-medium text-gray-500">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï ‡¶Ü‡¶á‡¶°‡¶ø:</span> 
                                    <span class="font-semibold text-gray-700">${proof.facebookName}</span>
                                </span>
                            </p>
                            
                            <!-- üî• ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®: ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡ßç‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡¶® (Cloudinary URL) -->
                            ${proof.screenshotUrl ? `
                                <div class="pt-2 border-t border-gray-100">
                                    <p class="flex items-start mb-2">
                                        <i class="fas fa-image text-green-500 mr-2 mt-1"></i>
                                        <span>
                                            <span class="font-medium text-gray-500 block">‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶™‡ßç‡¶∞‡ßÅ‡¶´:</span>
                                            <a href="${proof.screenshotUrl}" target="_blank" class="brand-blue-text hover:underline break-all font-mono text-xs">${proof.screenshotUrl.substring(0, 60)}...</a>
                                        </span>
                                    </p>
                                    <!-- ‡¶á‡¶Æ‡ßá‡¶ú ‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â: ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡¶≤‡ßá ‡¶õ‡¶¨‡¶ø‡¶ü‡¶ø ‡¶¨‡¶°‡¶º ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá -->
                                    <img src="${proof.screenshotUrl}" alt="‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶™‡ßç‡¶∞‡ßÅ‡¶´" 
                                         class="w-full h-auto max-h-40 object-contain rounded-lg border border-gray-200 cursor-pointer"
                                         onclick="window.open('${proof.screenshotUrl}', '_blank')" />
                                </div>
                            ` : ''}

                            <!-- ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º -->
                            <p class="flex items-center">
                                <i class="fas fa-clock text-gray-500 mr-2"></i>
                                <span>
                                    <span class="font-medium text-gray-500">‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º:</span> 
                                    <span class="font-semibold text-gray-700">${formatDate(proof.submittedAt)}</span>
                                </span>
                            </p>
                            
                            ${proof.status !== 'pending' && proof.reviewedBy // ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶π‡¶Ø‡¶º‡ßá ‡¶ó‡ßá‡¶≤‡ßá ‡¶è‡¶á ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá
                                ? `<p class="flex items-center pt-2 border-t border-gray-100">
                                         <i class="fas fa-user-shield text-indigo-500 mr-2"></i>
                                         <span>
                                             <span class="font-medium text-gray-500">‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®:</span> 
                                             <span class="font-semibold text-gray-700">${reviewerDisplayName}</span>
                                         </span>
                                     </p>`
                                : ''
                            }

                            ${proof.status === 'rejected' && proof.rejectionReason 
                                ? `<div class="bg-red-50 p-3 rounded-lg mt-3 text-red-700 border-l-4 border-red-400">
                                     <i class="fas fa-exclamation-triangle mr-1"></i> 
                                     <span class="font-bold">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤‡ßá‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£:</span> ${proof.rejectionReason}
                                   </div>`
                                : ''
                            }
                        </div>
                    </div>
                `;
                submittedProofsList.insertAdjacentHTML('beforeend', card);
            });
        };

        const listenForTasks = () => {
            if (!userId) return;

            const tasksRef = ref(rtdb, `tasks`);
            
            onValue(tasksRef, async (snapshot) => { // async ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                const allTasks = snapshot.val() || {};
                const availableTasks = [];
                const submittedProofs = [];
                const requiredUserIds = new Set(); // üî• ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡ßá‡¶ü: ‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï ‡¶ì ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â‡¶Ø‡¶º‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡¶æ
                
                for (const taskId in allTasks) {
                    const task = allTasks[taskId];
                    if (task && task.ownerId) { 
                        
                        // üî• ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï‡ßá‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡¶æ
                        requiredUserIds.add(task.ownerId);

                        const userStatus = userCompletedTasks[taskId];
                        
                        if (task.ownerId !== userId) {
                            
                            let pendingProofCount = 0; // üî• ‡¶®‡¶§‡ßÅ‡¶®: ‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞
                            
                            if (task.proofs) {
                                for (const proofId in task.proofs) {
                                    const proof = task.proofs[proofId];
                                    
                                    if (proof.status === 'pending') {
                                        pendingProofCount++; // üî• ‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶ó‡¶£‡¶®‡¶æ
                                    }
                                    
                                    if (proof.userId === userId) {
                                        submittedProofs.push({
                                            proofId: proofId,
                                            taskId: taskId,
                                            taskType: task.taskType,
                                            taskLink: task.taskLink,
                                            pointsPerTask: task.pointsPerTask,
                                            ...proof
                                        });
                                        // üî• ‡¶Ø‡¶¶‡¶ø ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶π‡¶Ø‡¶º‡ßá ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â‡¶Ø‡¶º‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡¶æ
                                        if (proof.reviewedBy) {
                                            requiredUserIds.add(proof.reviewedBy);
                                        }
                                    }
                                }
                            }

                            // Old logic for available tasks 
                            let statusToDisplay = userStatus || 'available'; // available or pending

                            if (task.proofs) {
                                const userProofs = Object.keys(task.proofs)
                                    .map(proofId => ({ id: proofId, ...task.proofs[proofId] }))
                                    .filter(p => p.userId === userId)
                                    .sort((a, b) => b.submittedAt - a.submittedAt); 

                                const latestProof = userProofs[0];

                                if(latestProof) {
                                    statusToDisplay = latestProof.status;
                                }
                            }
                            
                            // üî• ‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ ‡¶§‡¶æ ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶≤‡¶ú‡¶ø‡¶ï:
                            const approvedCount = task.completedCount || 0;
                            const totalProofCount = approvedCount + pendingProofCount;
                            const isTargetReached = totalProofCount >= task.quantity;
                            
                            // ‡¶∂‡¶∞‡ßç‡¶§: ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá AND ‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶®‡¶æ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá AND (‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶π‡¶Ø‡¶º ‡¶∞‡¶ø‡¶ú‡ßá‡¶ï‡ßç‡¶ü ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá OR ‡¶è‡¶ñ‡¶®‡ßã ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßá‡¶®‡¶ø)
                            if (task.status === 'active' && !isTargetReached && (statusToDisplay === 'rejected' || statusToDisplay === 'available')) {
                                availableTasks.push({ id: taskId, ...task });
                            }
                            
                            // pending ‡¶¨‡¶æ approved ‡¶π‡¶≤‡ßá, ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï‡¶ü‡¶ø ‡¶Ü‡¶∞ Available ‡¶∏‡ßá‡¶ï‡¶∂‡¶®‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá ‡¶®‡¶æ (‡¶ï‡¶æ‡¶∞‡¶£ statusToDisplay 'rejected' ‡¶¨‡¶æ 'available' ‡¶®‡¶Ø‡¶º)
                        }
                    }
                }

                // üî• ‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï ‡¶ì ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â‡¶Ø‡¶º‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶ï‡¶∞‡¶æ
                await cacheUserProfiles(requiredUserIds);
                
                // Sort submitted proofs by submission time (latest first)
                submittedProofs.sort((a, b) => b.submittedAt - a.submittedAt); 
                
                displayAvailableTasks(availableTasks);
                displaySubmittedProofs(submittedProofs); 
            });
        };

        const displayAvailableTasks = (tasks) => {
            availableTasksGrid.innerHTML = '';
            if (tasks.length === 0) {
                availableTasksGrid.innerHTML = '<div class="col-span-full text-center py-12 text-gray-500 text-lg">‚ú® ‡¶è‡¶ñ‡¶® ‡¶ï‡ßã‡¶®‡ßã ‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß ‡¶ï‡¶æ‡¶ú ‡¶®‡ßá‡¶á‡•§ ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</div>';
                return;
            }

            tasks.forEach(task => {
                const completedCount = task.completedCount || 0; 
                
                // üî• ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                const ownerInfoHtml = getOwnerInfoHtml(task.ownerId);

                const taskCard = `
                    <div class="app-card p-5">
                        
                        <!-- ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ, ‡¶õ‡¶¨‡¶ø ‡¶ì ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç -->
                        <div class="mb-3 pb-3 border-b border-gray-100">
                            ${ownerInfoHtml}
                        </div>
                        
                        <div class="flex justify-between items-start mb-4">
                            ${getTaskTypeBadge(task.taskType)}
                            <div class="bg-gradient-to-r from-green-400 to-green-600 text-white font-bold px-3 py-1 rounded-full text-sm shadow-md">
                                + ${formatPoints(task.pointsPerTask)} ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü
                            </div>
                        </div>
                        <h4 class="text-xl font-semibold text-gray-800 mb-4">${task.taskType} ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®</h4>
                        <div class="space-y-2 text-sm text-gray-600 mb-6">
                            <p class="flex justify-between items-center">
                                <span><i class="fas fa-bullseye text-blue-500 mr-2"></i> ‡¶Æ‡ßã‡¶ü ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø:</span> 
                                <span class="font-bold text-base">${formatPoints(task.quantity)} ‡¶ü‡¶ø</span>
                            </p>
                            <p class="flex justify-between items-center">
                                <span><i class="fas fa-check-double text-green-500 mr-2"></i> ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá:</span> 
                                <span class="font-bold text-base text-green-600">${formatPoints(completedCount)} ‡¶ü‡¶ø</span>
                            </p>
                            <div class="pt-3 border-t border-gray-100">
                                <span class="block mb-1 text-gray-500 font-medium text-xs">‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶≤‡¶ø‡¶Ç‡¶ï:</span> 
                                <a href="${task.taskLink}" target="_blank" class="brand-blue-text hover:underline text-sm break-all font-mono">${task.taskLink}</a>
                            </div>
                        </div>
                        <button class="w-full brand-blue text-white py-2.5 px-4 text-base font-bold rounded-lg hover:brightness-110 shadow-md" onclick="openSubmitProofModal('${task.id}')">
                            <i class="fas fa-hand-pointer mr-2"></i> ‡¶ï‡¶æ‡¶ú‡¶ü‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®
                        </button>
                    </div>
                `;
                availableTasksGrid.insertAdjacentHTML('beforeend', taskCard);
            });
        };

        window.openSubmitProofModal = (taskId) => {
            currentTaskId = taskId;
            
            // ‡¶∂‡ßá‡¶∑‡¶¨‡¶æ‡¶∞ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶°‡ßá‡¶ü‡¶æ ‡¶¶‡¶ø‡ßü‡ßá ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶´‡¶ø‡¶≤‡ßç‡¶°‡¶ó‡ßÅ‡¶≤‡ßã ‡¶∏‡ßç‡¶¨‡ßü‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡ßü‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá
            document.getElementById('facebookName').value = lastFacebookName;
            
            // ‡¶´‡¶æ‡¶á‡¶≤ ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
            document.getElementById('screenshotFile').value = '';
            
            submitProofModal.classList.remove('hidden');
        };

        submitProofForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const submitButton = submitProofForm.querySelector('button[type="submit"]');
            submitButton.disabled = true;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';

            const facebookName = document.getElementById('facebookName').value.trim();
            const screenshotInput = document.getElementById('screenshotFile');
            const screenshotFile = screenshotInput.files[0];
            
            // ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            if (!facebookName || !screenshotFile) {
                showNotification('‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï ‡¶Ü‡¶á‡¶°‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§', 'error');
                submitButton.disabled = false;
                submitButton.innerHTML = '<i class="fas fa-upload mr-2"></i> ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®';
                return;
            }

            if (!currentTaskId || !userId) {
                showNotification('‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ‡¶ï‡¶æ‡¶ú ‡¶¨‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§', 'error');
                submitButton.disabled = false;
                submitButton.innerHTML = '<i class="fas fa-upload mr-2"></i> ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®';
                return;
            }
            
            let screenshotUrl = ''; // Cloudinary URL ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

            try {
                // üî• Cloudinary ‡¶§‡ßá ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
                screenshotUrl = await uploadToCloudinary(screenshotFile);

                if (!screenshotUrl) {
                    throw new Error("Cloudinary ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡ßã‡¶®‡ßã URL ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§");
                }
                
                const proofRef = ref(rtdb, `tasks/${currentTaskId}/proofs`);
                
                // proofData ‡¶§‡ßá screenshotUrl ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                const proofData = {
                    userId: userId,
                    userName: currentUserName,
                    facebookName: facebookName, 
                    screenshotUrl: screenshotUrl, // üî• ‡¶®‡¶§‡ßÅ‡¶®: URL ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                    submittedAt: Date.now(), 
                    status: 'pending' 
                };

                const userCompletedTaskRef = ref(rtdb, `users/${userId}/completedTasks/${currentTaskId}`);
                await set(userCompletedTaskRef, 'pending');
                
                await push(proofRef, proofData);

                // *** ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ú‡¶®: ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤‡ßá ‡¶∂‡ßá‡¶∑ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ***
                const userUpdateRef = ref(rtdb, `users/${userId}`);
                await update(userUpdateRef, {
                    lastFacebookName: facebookName,
                });
                // *******************************************************************

                showNotification('‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá! ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶ï‡¶∞‡¶¨‡ßá‡•§', 'success');
                submitProofForm.reset();
                closeModal('submit-proof-modal');

            } catch (error) {
                console.error("Proof submission failed:", error);
                // Cloudinary error already handled by showNotification inside uploadToCloudinary
                if (!error.message.includes('Cloudinary')) { 
                    showNotification(`‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•: ${error.message}`, 'error');
                }
            } finally {
                submitButton.disabled = false;
                submitButton.innerHTML = '<i class="fas fa-upload mr-2"></i> ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®';
            }
        });

        window.logout = logout;
        window.closeModal = (modalId) => {
            document.getElementById(modalId).classList.add('hidden');
        };

        window.onclick = function(event) {
            if (event.target === submitProofModal) {
                submitProofModal.classList.add('hidden');
            }
        };
    </script>
</body>
</html>

