<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LikeDokan</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"> </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* ‡¶´‡¶®‡ßç‡¶ü ‡¶ì ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶ó‡ßç‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶® */
        body {
    font-family: 'Hind Siliguri', Inter, sans-serif;
    background-color: #f7f9fc;
    min-height: 100vh;
}

        /* ‡¶¨‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶ï‡¶æ‡¶≤‡¶æ‡¶∞ - ‡¶Ü‡¶ß‡ßÅ‡¶®‡¶ø‡¶ï ‡¶®‡ßÄ‡¶≤ */
        .brand-blue {
            background-color: #0d6efd; /* ‡¶¨‡ßÅ‡¶ü‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶™ ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞‡¶ø ‡¶¨‡ßç‡¶≤‡ßÅ ‡¶è‡¶∞ ‡¶ï‡¶æ‡¶õ‡¶æ‡¶ï‡¶æ‡¶õ‡¶ø */
            transition: background-color 0.2s;
        }

        .brand-blue:hover {
            background-color: #0b5ed7;
        }

        .brand-blue-text {
            color: #0d6efd;
        }

        /* ‡¶ï‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ - ‡¶è‡¶≤‡¶ø‡¶≠‡ßá‡¶ü‡ßá‡¶° ‡¶≤‡ßÅ‡¶ï */
        .app-card {
            background: white;
            border-radius: 12px; /* ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶°‡ßá‡¶° */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); /* ‡¶π‡¶æ‡¶≤‡¶ï‡¶æ ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø‡¶Æ‡¶æ‡¶® ‡¶∂‡ßç‡¶Ø‡¶æ‡¶°‡ßã */
            border: 1px solid #e9ecef;
            transition: box-shadow 0.3s, transform 0.2s;
        }

        .app-card:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            transform: translateY(-1px);
        }

        /* ‡¶´‡¶ø‡¶ï‡ßç‡¶∏‡¶° ‡¶π‡ßá‡¶°‡¶æ‡¶∞ */
        .fixed-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 50;
            background: white;
            border-bottom: 1px solid #e9ecef;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        /* ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßç‡¶Ø‡¶æ‡¶°‡¶ø‡¶Ç - ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶∏‡ßç‡¶™‡ßá‡¶∏‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø, ‡¶°‡¶æ‡¶á‡¶®‡¶æ‡¶Æ‡¶ø‡¶ï ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶® JS ‡¶è ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡ßá‡¶≤ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá */
        #main-content-container {
            padding-top: 1rem; /* ‡¶π‡ßá‡¶°‡¶æ‡¶∞ ‡¶è‡¶∞ ‡¶®‡¶ø‡¶ö‡ßá ‡¶∏‡¶æ‡¶Æ‡¶æ‡¶®‡ßç‡¶Ø ‡¶∏‡ßç‡¶™‡ßá‡¶∏ */
            transition: margin-top 0.3s ease-out; /* ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶®‡ßá‡¶∞ ‡¶Æ‡¶∏‡ßÉ‡¶£ ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡¶ú‡¶ø‡¶∂‡¶® */
        }

        /* ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤‡¶ø‡¶Ç */
        .app-input {
            border: 1px solid #ced4da;
            border-radius: 8px;
            padding: 12px;
            font-size: 16px;
            background-color: white;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .app-input:focus {
            outline: none;
            border-color: #0d6efd;
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
        }

        /* ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶∏‡ßç‡¶™‡¶ø‡¶®‡¶æ‡¶∞ ‡¶ì ‡¶ì‡¶≠‡¶æ‡¶∞‡¶≤‡ßá ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ (‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§) */
        #loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
            gap: 1rem;
            color: #333;
            font-size: 1.25rem;
            font-weight: 600;
            opacity: 1; 
            pointer-events: all; 
            transition: opacity 0.5s ease-out; 
        }
        
        /* ‡¶ì‡¶≠‡¶æ‡¶∞‡¶≤‡ßá ‡¶Ö‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ */
        #loading-overlay.fade-out {
            opacity: 0;
            pointer-events: none; 
        }

        .spinner {
            border: 4px solid #e5e7eb;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-top-color: #0d6efd;
            animation: spin 1s ease infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* --- ‡¶õ‡ßã‡¶ü ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ (‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ï‡¶æ‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø) --- */
        .small-rating-bar {
            display: flex;
            align-items: center;
            gap: 2px;
        }
        .small-star {
            font-size: 0.75rem; /* ‡¶õ‡ßã‡¶ü ‡¶Ü‡¶ï‡¶æ‡¶∞ */
        }
        .filled-star {
            color: #ffc107; /* ‡¶∏‡ßã‡¶®‡¶æ‡¶≤‡ßÄ ‡¶∞‡¶Ç */
        }

        .empty-star {
            color: #e9ecef; /* ‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶§‡¶æ‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶π‡¶æ‡¶≤‡¶ï‡¶æ ‡¶ß‡ßÇ‡¶∏‡¶∞ */
        }
        
        .small-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background-color: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4b5563;
            font-size: 0.7rem;
            font-weight: bold;
            overflow: hidden;
            flex-shrink: 0; /* ‡¶õ‡ßã‡¶ü ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡ßá ‡¶∏‡¶ô‡ßç‡¶ï‡ßÅ‡¶ö‡¶ø‡¶§ ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ü‡¶ü‡¶ï‡¶æ‡¶¨‡ßá */
        }
        .small-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        /* --- ‡¶õ‡ßã‡¶ü ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ ‡¶∂‡ßá‡¶∑ --- */

        /* üî• ‡¶®‡¶§‡ßÅ‡¶®: ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡¶∂‡¶® ‡¶π‡¶≤‡ßá ‡¶¨‡ßç‡¶≤‡¶æ‡¶∞ ‡¶ì ‡¶¨‡ßç‡¶≤‡¶ï */
        .content-suspended {
            pointer-events: none;
            filter: blur(4px) grayscale(50%); /* ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶¨‡ßç‡¶≤‡¶æ‡¶∞ */
            user-select: none;
        }
        
        /* üî• ‡¶Ü‡¶™‡¶°‡ßá‡¶ü: ‡¶ü‡ßç‡¶∞‡¶æ‡¶∏‡ßç‡¶ü ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
        #trust-notice-board {
            position: fixed;
            top: 64px; /* ‡¶π‡ßá‡¶°‡¶æ‡¶∞ ‡¶è‡¶∞ ‡¶®‡¶ø‡¶ö‡ßá */
            left: 0;
            right: 0;
            z-index: 45; /* ‡¶π‡ßá‡¶°‡¶æ‡¶∞ (z-50) ‡¶è‡¶∞ ‡¶®‡¶ø‡¶ö‡ßá */
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
            transition: all 0.3s ease;
        }
        
        /* üî• ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡¶∂‡¶® ‡¶Æ‡ßã‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶ï‡¶æ‡¶≤‡¶æ‡¶∞ */
        #trust-notice-board.suspended-mode {
            background-color: #fef2f2; /* ‡¶≤‡¶æ‡¶≤ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶ó‡ßç‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° */
            border-bottom: 2px solid #ef4444; /* ‡¶≤‡¶æ‡¶≤ ‡¶¨‡¶∞‡ßç‡¶°‡¶æ‡¶∞ */
            box-shadow: 0 4px 8px rgba(239, 68, 68, 0.2); /* ‡¶≤‡¶æ‡¶≤ ‡¶∂‡ßç‡¶Ø‡¶æ‡¶°‡ßã */
            cursor: not-allowed;
            pointer-events: all; /* ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶°‡¶ü‡¶ø ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶•‡¶æ‡¶ï‡¶¨‡ßá */
            z-index: 100; /* üî• ‡¶´‡¶ø‡¶ï‡ßç‡¶∏: ‡¶™‡ßá‡¶ú ‡¶¨‡ßç‡¶≤‡¶æ‡¶∞ ‡¶π‡¶≤‡ßá‡¶ì ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶°‡¶ü‡¶ø ‡¶â‡¶™‡¶∞‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá */
        }
    </style>
</head>
<body>
    
    <!-- üî• ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡¶∂‡¶® ‡¶Æ‡¶°‡¶æ‡¶≤‡¶ü‡¶ø ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡¶≤‡ßã -->

    <!-- ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶ì‡¶≠‡¶æ‡¶∞‡¶≤‡ßá -->
    <div id="loading-overlay">
        <div class="spinner"></div>
        <p>‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
    </div>

    <!-- ‡¶π‡ßá‡¶°‡¶æ‡¶∞ -->
    <header class="fixed-header" id="app-header">
        <div class="container max-w-6xl mx-auto px-4 py-3 flex justify-between items-center h-16">
            
            <!-- ‡¶≤‡ßã‡¶ó‡ßã ‡¶è‡¶¨‡¶Ç ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤ -->
            <div class="text-xl font-extrabold brand-blue-text flex items-center">
                <span class="mr-2 text-3xl"></span> Like Dokan
            </div>
            
            <!-- ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ú ‡¶ì ‡¶®‡ßá‡¶≠‡¶ø‡¶ó‡ßá‡¶∂‡¶® -->
            <div class="flex items-center gap-0">
                <!-- text-0.1 ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßá text-sm ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã -->
                <div class="bg-gradient-to-r from-blue-300 to-blue-600 text-white font-bold px-3 py-0.5 rounded-full text-sm flex items-center shadow-md">
                    <i class="fas fa-coins mr-2"></i>
                    <span id="user-points">0</span>
                </div>
                
                <!-- ‡¶®‡ßá‡¶≠‡¶ø‡¶ó‡ßá‡¶∂‡¶® ‡¶¨‡¶æ‡¶ü‡¶® -->
                <button class="w-10 h-10 rounded-full hover:bg-gray-100 transition duration-200 text-gray-600" title="‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ì ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂‡¶ø‡¶ï‡¶æ" onclick="window.location.href='report.html'">
                    <i class="fas fa-info-circle text-lg"></i>
                </button>
                <button class="w-10 h-10 rounded-full hover:bg-gray-100 transition duration-200 text-gray-600" title="‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤" onclick="window.location.href='profile.html'">
                    <i class="fas fa-user text-lg"></i>
                </button>
                <button class="w-10 h-10 rounded-full hover:bg-gray-100 transition duration-200 text-gray-600" title="‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü" onclick="window.logout()">
                    <i class="fas fa-sign-out-alt text-lg"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- ‡¶ü‡ßç‡¶∞‡¶æ‡¶∏‡ßç‡¶ü ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ / ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡¶∂‡¶® ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶° (‡¶è‡¶ï‡¶á ‡¶á‡¶≤‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü) -->
    <!-- üî• ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶°‡¶ø‡¶∏‡¶™‡ßç‡¶≤‡ßá ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶Ü‡¶á‡¶°‡¶ø ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã -->
    <div id="trust-notice-board" class="hidden fixed z-40 py-2 bg-red-100 border-b-2 border-red-500 shadow-lg transition-all duration-300">
        <div class="container max-w-4xl mx-auto px-4 text-center">
            <!-- ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç/‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡¶∂‡¶® ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶°‡¶ø‡¶∏‡¶™‡ßç‡¶≤‡ßá ‡¶π‡¶¨‡ßá -->
            <p id="notice-message" class="text-sm font-semibold text-red-800">
                <i class="fas fa-exclamation-triangle mr-2"></i>
                ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ trust Score ‡¶ï‡¶Æ‡•§ ‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶®‡¶æ‡¶π‡¶≤‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡ßç‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá‡•§
            </p>
            
            <!-- üî• ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡¶∂‡¶® ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶® ‡¶ì ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶°‡¶ø‡¶∏‡¶™‡ßç‡¶≤‡ßá -->
            <div id="suspension-details" class="hidden mt-1 flex flex-col md:flex-row justify-center items-center text-xs md:text-sm font-bold text-red-900 space-y-1 md:space-y-0 md:space-x-4">
                <p><i class="fas fa-clock mr-1"></i> ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶∏‡¶Æ‡¶Ø‡¶º: <span id="suspend-countdown-display">‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</span></p>
                <p><i class="fas fa-gavel mr-1"></i> ‡¶ï‡¶æ‡¶∞‡¶£: <span id="suspend-reason-display"></span></p>
            </div>
        </div>
    </div>
    
    <!-- ‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü -->
    <div class="container max-w-4xl mx-auto px-4 mt-2 hidden" id="main-content-container">
        
        <main>
            <!-- ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶® ‡¶ï‡¶æ‡¶∞‡ßç‡¶° (Quick Actions Card) -->
            <div class="app-card p-6 mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center border-b pb-4">
                    ‚öôÔ∏è ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®
                </h2>
                <!-- üî• ‡¶Ü‡¶™‡¶°‡ßá‡¶ü: ‡ß™‡¶ü‡¶ø ‡¶¨‡¶æ‡¶ü‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ó‡ßç‡¶∞‡¶ø‡¶° ‡¶†‡¶ø‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <a href="order.html" class="block brand-blue text-center py-3 px-2 text-xs md:text-sm font-bold rounded-xl text-white hover:shadow-xl hover:brightness-110 transform transition duration-300 shadow-md">
                        <i class="fas fa-plus-circle block md:hidden mb-1"></i> 
                        <span class="hidden md:inline"><i class="fas fa-plus-circle mr-1"></i></span> ‡¶®‡¶§‡ßÅ‡¶® ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞
                    </a>
                    <a href="profile.html" class="block bg-gray-500 text-center py-3 px-2 text-xs md:text-sm font-bold rounded-xl text-white hover:bg-gray-600 hover:shadow-xl transform transition duration-300 shadow-md">
                         <i class="fas fa-user block md:hidden mb-1"></i>
                         <span class="hidden md:inline"><i class="fas fa-user mr-1"></i></span> ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤
                    </a>
                    <a href="leaderboard.html" class="block bg-yellow-500 text-center py-3 px-2 text-xs md:text-sm font-bold rounded-xl text-white hover:bg-yellow-600 hover:shadow-xl transform transition duration-300 shadow-md">
                         <i class="fas fa-crown block md:hidden mb-1"></i>
                         <span class="hidden md:inline"><i class="fas fa-crown mr-1"></i></span> ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°
                    </a>
                    <a href="report.html" class="block bg-red-500 text-center py-3 px-2 text-xs md:text-sm font-bold rounded-xl text-white hover:bg-red-600 hover:shadow-xl transform transition duration-300 shadow-md">
                         <i class="fas fa-bug block md:hidden mb-1"></i>
                         <span class="hidden md:inline"><i class="fas fa-bug mr-1"></i></span> ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü/‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂‡¶ø‡¶ï‡¶æ
                    </a>
                </div>
            </div>
            
            <!-- Admin/Moderator Links (Hidden by default) -->
            <div class="app-card p-6 mb-8 hidden" id="admin-mod-links-section">
                <h2 class="text-xl font-bold text-gray-800 mb-6 text-center border-b pb-4">
                    üîê ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <a href="admin.html" id="admin-link" class="block bg-indigo-600 text-center py-3 px-4 text-sm font-bold rounded-xl text-white hover:bg-indigo-700 hover:shadow-xl transform transition duration-300 shadow-md hidden">
                        <i class="fas fa-tools mr-1"></i> ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°
                    </a>
                    <a href="moderator.html" id="moderator-link" class="block bg-pink-600 text-center py-3 px-4 text-sm font-bold rounded-xl text-white hover:bg-pink-700 hover:shadow-xl transform transition duration-300 shadow-md hidden">
                        <i class="fas fa-user-shield mr-1"></i> ‡¶Æ‡¶°‡¶æ‡¶∞‡ßá‡¶ü‡¶∞ ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤
                    </a>
                </div>
            </div>

            <!-- ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶ì ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶° -->
            <div class="app-card p-6 mb-8" id="dashboard">
                
                <!-- ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡ßá‡¶ï‡¶∂‡¶® -->
                <div class="flex items-center gap-4 mb-6 pb-6 border-b border-gray-100">
                    <!-- w-20 h-11 ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßá w-20 h-20 ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã -->
                    <div class="w-20 h-20 bg-gray-100 brand-blue-text rounded-full flex items-center justify-center text-3xl font-bold overflow-hidden border-2 border-gray-300" id="profile-avatar">
                        S
                    </div>
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800" id="user-name-display">‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ</h3>
                        <p class="text-gray-500 text-sm mt-1">
                            ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø: <span id="user-id-display" class="font-mono text-xs bg-gray-100 px-2 py-0.5 rounded">user123</span>
                        </p>
                    </div>
                </div>

                <!-- ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶® -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    
                    <div class="stat-card p-4 text-center bg-yellow-50 rounded-lg shadow-sm">
                        <i class="fas fa-star text-3xl text-yellow-500 mb-2"></i>
                        <div class="text-2xl font-bold text-gray-800" id="total-points">‡ß¶</div>
                        <div class="text-sm text-gray-500">‡¶Æ‡ßã‡¶ü ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü</div>
                    </div>
                    
                    <div class="stat-card p-4 text-center bg-blue-50 rounded-lg shadow-sm">
                        <i class="fas fa-chart-line text-3xl brand-blue-text mb-2"></i>
                        <div class="text-2xl font-bold text-gray-800" id="total-tasks-created">‡ß¶</div>
                        <div class="text-sm text-gray-500">‡¶§‡ßà‡¶∞‡¶ø‡¶ï‡ßÉ‡¶§ ‡¶ï‡¶æ‡¶ú</div>
                    </div>
                    
                    <div class="stat-card p-4 text-center bg-green-50 rounded-lg shadow-sm">
                        <i class="fas fa-check-circle text-3xl text-green-500 mb-2"></i>
                        <div class="text-2xl font-bold text-gray-800" id="total-tasks-completed">‡ß¶</div>
                        <div class="text-sm text-gray-500">‡¶∏‡¶´‡¶≤ ‡¶ï‡¶æ‡¶ú</div>
                    </div>
                    
                    <div class="stat-card p-4 text-center bg-red-50 rounded-lg shadow-sm">
                        <i class="fas fa-times-circle text-3xl text-red-500 mb-2"></i>
                        <div class="text-2xl font-bold text-gray-800" id="total-tasks-rejected">‡ß¶</div>
                        <div class="text-sm text-gray-500">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶æ‡¶ú</div>
                    </div>
                </div>
            </div>

            <!-- ‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï -->
            <div class="app-card p-6 mb-8" id="available-tasks-section">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center border-b pb-4">
                    üéØ ‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßÇ‡¶π
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="available-tasks-grid">
                    <!-- Tasks will be loaded here -->
                </div>
            </div>
            
            <!-- ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ (NEW SECTION) -->
            <div class="app-card p-6 mb-8" id="submitted-proofs-section">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center border-b pb-4">
                    üìù ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏
                </small-avatar
                <div id="submitted-proofs-list" class="space-y-4">
                    <!-- Proofs will be loaded here -->
                </div>
            </div>
            
            <!-- '‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®‡¶ï‡ßÉ‡¶§ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï' ‡¶∏‡ßá‡¶ï‡¶∂‡¶®‡¶ü‡¶ø ‡¶è‡¶ñ‡¶æ‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶¨‡¶æ‡¶¶ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá -->

        </main>
    </div>

    <!-- ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶® ‡¶Æ‡¶°‡¶æ‡¶≤ (‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§: ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶®‡¶æ‡¶Æ ‡¶ì ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü) -->
    <div id="submit-proof-modal" class="fixed inset-0 z-50 flex justify-center items-center p-4 transition-opacity duration-300 hidden" style="background-color: rgba(0, 0, 0, 0.4);">
        <div class="app-card p-6 w-full max-w-md relative animate-in zoom-in-50 duration-300">
            <button class="absolute top-3 right-3 text-gray-500 hover:text-gray-800 text-3xl transition" onclick="closeModal('submit-proof-modal')">
                &times;
            </button>
            <h2 class="text-xl font-bold text-gray-800 mb-6 border-b pb-3">‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï ‡¶Ü‡¶á‡¶°‡¶ø ‡¶ì ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®</h2>
            <form id="submitProofForm">
                
                <!-- ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï ‡¶Ü‡¶á‡¶°‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ -->
                <div class="mb-4">
                    <label for="facebookName" class="block text-sm font-medium text-gray-700 mb-2">
                        ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï ‡¶Ü‡¶á‡¶°‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ:
                    </label>
                    <!-- autocomplete="off" ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶Ø‡¶æ‡¶§‡ßá ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü ‡¶∏‡¶æ‡¶ú‡ßá‡¶∂‡¶® ‡¶®‡¶æ ‡¶Ü‡¶∏‡ßá -->
                    <input type="text" id="facebookName" name="facebookName" 
                           class="app-input w-full" 
                           placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: Shuvo Ahamed" required autocomplete="off">
                    <p class="text-xs text-gray-500 mt-1">‡¶è‡¶á ‡¶§‡¶•‡ßç‡¶Ø‡¶ü‡¶ø ‡¶∂‡ßá‡¶∑‡¶¨‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßç‡¶¨‡ßü‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡ßü‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã‡•§</p>
                </div>

                <!-- ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü -->
                <div class="mb-6">
                    <label for="screenshotFile" class="block text-sm font-medium text-gray-700 mb-2">
                        ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®:
                    </label>
                    <input type="file" id="screenshotFile" name="screenshotFile" accept="image/*"
                           class="w-full text-sm text-gray-500
                                  file:mr-4 file:py-2 file:px-4
                                  file:rounded-full file:border-0
                                  file:text-sm file:font-semibold
                                  file:bg-blue-50 file:text-blue-700
                                  hover:file:bg-blue-100" required>
                    <p class="text-xs text-gray-500 mt-1">‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ JPG/PNG ‡¶´‡¶æ‡¶á‡¶≤ ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø‡•§ (‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶æ‡¶á‡¶ú ‡¶ï‡¶Æ ‡¶∞‡¶æ‡¶ñ‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®)</p>
                </div>
                
                <button type="submit" class="w-full brand-blue text-white py-3 text-center rounded-lg font-bold hover:shadow-lg transition duration-200">
                    <i class="fas fa-upload mr-2"></i> ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®
                </button>
            </form>
        </div>
    </div>
    
    <div id="notification-container" class="fixed bottom-4 right-4 z-50 space-y-2"></div>
    
    <script type="module">
        // Firebase RTDB imports
        import { auth, rtdb, showNotification, logout } from './rtdb-config.js';
        import { onAuthStateChanged, setPersistence, browserSessionPersistence, signInWithCustomToken, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js";
        import { set, ref, onValue, push, update, get } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-database.js";
        
        const loadingOverlay = document.getElementById('loading-overlay');
        const mainContentContainer = document.getElementById('main-content-container');
        const availableTasksGrid = document.getElementById('available-tasks-grid');
        const availableTasksSection = document.getElementById('available-tasks-section');
        // ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ú‡¶®: ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶è‡¶≤‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü
        const trustNoticeBoard = document.getElementById('trust-notice-board');
        const appHeader = document.getElementById('app-header');

        // üî• ‡¶®‡¶§‡ßÅ‡¶®: ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶á‡¶≤‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡¶∏
        const noticeMessage = document.getElementById('notice-message');
        const suspensionDetails = document.getElementById('suspension-details');
        const suspendCountdownDisplay = document.getElementById('suspend-countdown-display'); 
        const suspendReasonDisplay = document.getElementById('suspend-reason-display');


        const submitProofModal = document.getElementById('submit-proof-modal');
        const submitProofForm = document.getElementById('submitProofForm');
        
        let currentTaskId = null;
        let userId = null;
        let currentUserPoints = 0;
        let currentUserName = '';
        let userCompletedTasks = {};
        let currentUserData = {}; 
        
        let lastFacebookName = '';
        
        let authAndDataLoaded = false;
        
        let userProfileCache = {}; 
        
        let countdownInterval = null; 

        // ----------------------------------------------------------------------
        // üî• Cloudinary ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶®: ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶Ü‡¶™‡¶≤‡ßã‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
        // ----------------------------------------------------------------------
        const CLOUDINARY_CLOUD_NAME = 'deqeko2ny'; // profile.html ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡ßá‡¶ì‡ßü‡¶æ
        const CLOUDINARY_UPLOAD_PRESET = 'Profilepicture'; // profile.html ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡ßá‡¶ì‡ßü‡¶æ
        const CLOUDINARY_URL = `https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`;
        // ----------------------------------------------------------------------

        /**
         * ‡¶∏‡¶Æ‡¶Ø‡¶º‡¶ï‡¶æ‡¶≤‡¶ï‡ßá (‡¶Æ‡¶ø‡¶≤‡¶ø‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°) ‡¶ò‡¶®‡ßç‡¶ü‡¶æ, ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü, ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶ï‡¶∞‡ßá ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Ç ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá‡•§
         * @param {number} ms - ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶∏‡¶Æ‡¶Ø‡¶º (‡¶Æ‡¶ø‡¶≤‡¶ø‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°)
         * @returns {string} - ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Ç (‡¶Ø‡ßá‡¶Æ‡¶®: ‡ßß ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡ß©‡ß´ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡ß¶‡ß™ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°)
         */
        const formatDurationInBangla = (ms) => {
            const totalSeconds = Math.max(0, Math.floor(ms / 1000));
            
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;
            
            const parts = [];
            
            // üî• ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ
            const toBanglaNum = (num) => num.toLocaleString('bn-BD');

            if (hours > 0) {
                parts.push(`${toBanglaNum(hours)} ‡¶ò‡¶®‡ßç‡¶ü‡¶æ`);
            }
            if (minutes > 0) {
                parts.push(`${toBanglaNum(minutes)} ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü`);
            }
            // ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶∏‡¶¨‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá ‡¶Ø‡¶¶‡¶ø totalSeconds > 0
            if (totalSeconds > 0 && seconds >= 0) {
                 parts.push(`${toBanglaNum(seconds)} ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°`);
            } else if (totalSeconds === 0) {
                return '‡ß¶ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°';
            }

            return parts.join(' ');
        }
        
        /**
         * ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡¶∂‡¶®‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶∏‡¶Æ‡¶Ø‡¶º‡ßá‡¶∞ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶® ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßá‡•§
         * @param {number} suspendUntil - ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡¶∂‡¶®‡ßá‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶∏‡¶Æ‡¶Ø‡¶º (‡¶Æ‡¶ø‡¶≤‡¶ø‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°)
         */
        const startSuspensionCountdown = (suspendUntil) => {
            if (countdownInterval) {
                clearInterval(countdownInterval);
                countdownInterval = null;
            }
            
            const updateCountdown = () => {
                const now = Date.now();
                const remainingTime = suspendUntil - now;
                
                if (remainingTime <= 0) {
                    clearInterval(countdownInterval);
                    countdownInterval = null;
                    suspendCountdownDisplay.textContent = '‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶∂‡ßá‡¶∑! ‡¶™‡ßá‡¶ú ‡¶∞‡¶ø‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®‡•§';
                    // ‡ß´ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞ ‡¶∞‡¶ø‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
                    setTimeout(() => window.location.reload(), 5000); 
                    return;
                }
                
                suspendCountdownDisplay.textContent = formatDurationInBangla(remainingTime);
            };
            
            // ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶æ
            updateCountdown(); 
            // ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
            countdownInterval = setInterval(updateCountdown, 1000); 
        };


        /**
         * ‡¶¨‡¶°‡¶º ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶ï‡ßá ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§ ‡¶´‡¶∞‡ßç‡¶Æ‡ßá (K, M, B) ‡¶∞‡ßÇ‡¶™‡¶æ‡¶®‡ßç‡¶§‡¶∞ ‡¶ï‡¶∞‡ßá‡•§
         * @param {number} num - ‡¶Ø‡ßá ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶ü‡¶ø ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá‡•§
         * @returns {string} - ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Ç (‡¶Ø‡ßá‡¶Æ‡¶®: 10000 -> 10k)
         */
        const formatPoints = (num) => {
            // ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶ø ‡¶Ø‡ßá num ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ
            if (typeof num !== 'number' || isNaN(num)) {
                return '0';
            }
            
            // ‡¶ß‡¶®‡¶æ‡¶§‡ßç‡¶Æ‡¶ï ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶ø
            const absNum = Math.abs(num);
            
            if (absNum >= 1000000000) {
                // ‡¶¨‡¶ø‡¶≤‡¶ø‡¶Ø‡¶º‡¶® (B) - 1000,000,000
                return (num / 1000000000).toFixed(1).replace(/\.0$/, '') + 'B';
            }
            if (absNum >= 1000000) {
                // ‡¶Æ‡¶ø‡¶≤‡¶ø‡¶Ø‡¶º‡¶® (M) - 1,000,000
                const formatted = (num / 1000000).toFixed(1);
                // ‡¶Ø‡¶¶‡¶ø .0 ‡¶è ‡¶∂‡ßá‡¶∑ ‡¶π‡¶Ø‡¶º, ‡¶§‡¶¨‡ßá .0 ‡¶¨‡¶æ‡¶¶ ‡¶¶‡ßá‡¶¨‡ßá
                if (formatted.endsWith('.0')) {
                    return formatted.slice(0, -2) + 'M';
                }
                return formatted + 'M';
            }
            if (absNum >= 10000) {
                // ‡¶π‡¶æ‡¶ú‡¶æ‡¶∞ (k) - 10,000 (‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ)
                const formatted = (num / 1000).toFixed(1);
                if (formatted.endsWith('.0')) {
                    return formatted.slice(0, -2) + 'k';
                }
                return formatted + 'k';
            }
            // 10,000 ‡¶è‡¶∞ ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶ï‡ßá ‡¶ï‡¶Æ‡¶æ ‡¶∏‡¶π ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßÄ‡¶Ø‡¶º ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá
            return num.toLocaleString('en');
        };

        const showContentAndHideLoader = () => {
            if (!authAndDataLoaded) {
                authAndDataLoaded = true;
                // 'hidden' ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡ßá 'fade-out' ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                loadingOverlay.classList.add('fade-out');
                mainContentContainer.classList.remove('hidden');
            }
        };

        setTimeout(() => {
            if (!authAndDataLoaded) {
                console.warn("Loading timeout exceeded. Showing content anyway.");
                showNotification('‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶§‡ßá ‡¶¨‡ßá‡¶∂‡¶ø ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶®‡¶ø‡¶ö‡ßç‡¶õ‡ßá, ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶¨‡¶æ ‡¶™‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'warning');
                showContentAndHideLoader();
            }
        }, 5000); 

        window.scrollToTasks = () => {
            if (availableTasksSection) {
                availableTasksSection.scrollIntoView({
                    behavior: 'smooth'
                });
            }
        };

        /**
         * ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡ßá‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ú ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá‡•§
         * @param {string} status - ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡ßá‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ('approved', 'rejected', 'pending')
         * @returns {string} - HTML ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ú ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Ç
         */
        const getStatusBadge = (status) => {
            const baseClasses = "px-3 py-1 text-sm font-medium rounded-full flex items-center shadow-sm";
            let colorClasses;
            let text;
            let icon;
            switch(status) {
                case 'approved':
                    colorClasses = 'bg-green-100 text-green-700';
                    text = '‡¶∏‡¶´‡¶≤';
                    icon = 'fas fa-check-circle';
                    break;
                case 'rejected':
                    colorClasses = 'bg-red-100 text-red-700';
                    text = '‡¶¨‡¶æ‡¶§‡¶ø‡¶≤';
                    icon = 'fas fa-times-circle';
                    break;
                default:
                    colorClasses = 'bg-yellow-100 text-yellow-700';
                    text = '‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶ö‡¶≤‡¶õ‡ßá';
                    icon = 'fas fa-hourglass-half';
            }
            return `<span class="${baseClasses} ${colorClasses}"><i class="${icon} mr-1"></i> ${text}</span>`;
        };
        
        const getTaskTypeBadge = (type) => {
             // ‡¶Ü‡¶ß‡ßÅ‡¶®‡¶ø‡¶ï ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ú ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤
            const baseClasses = "px-3 py-1 text-xs font-medium rounded-full capitalize shadow-sm";
            let colorClasses;
            switch(type.toLowerCase()) {
                case 'like':
                    colorClasses = "bg-blue-500 text-white";
                    break;
                case 'comment':
                    colorClasses = "bg-purple-500 text-white";
                    break;
                case 'share':
                    colorClasses = "bg-pink-500 text-white";
                    break;
                case 'group': // ‡¶®‡¶§‡ßÅ‡¶® ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ü‡¶æ‡¶á‡¶™‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                    colorClasses = "bg-teal-500 text-white";
                    break;
                default:
                    colorClasses = "bg-gray-200 text-gray-800";
            }
            return `<span class="${baseClasses} ${colorClasses}">${type}</span>`;
        }
        
        /**
         * ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º‡¶ï‡ßá ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßÄ‡ßü ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡ßü‡•§
         * @param {number} timestamp - ‡¶Æ‡¶ø‡¶≤‡¶ø‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá ‡¶∏‡¶Æ‡ßü
         * @returns {string} - ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶°‡ßá‡¶ü-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Ç
         */
        const formatDate = (timestamp) => {
            if (!timestamp) return 'N/A';
            const date = new Date(timestamp);
            return date.toLocaleString('bn-BD', { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric', 
                hour: '2-digit', 
                minute: '2-digit' 
            });
        };


        /**
         * ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∞‡ßã‡¶≤‡ßá‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø ‡¶ï‡¶∞‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶®/‡¶Æ‡¶°‡¶æ‡¶∞‡ßá‡¶ü‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø‡¶Æ‡¶æ‡¶®‡¶§‡¶æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßá‡•§
         * @param {string} role - ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∞‡ßã‡¶≤ ('user', 'moderator', 'admin')
         */
        const updateDashboardLinks = (role) => {
            const adminModSection = document.getElementById('admin-mod-links-section');
            const adminLink = document.getElementById('admin-link');
            const moderatorLink = document.getElementById('moderator-link');
            
            if (role === 'admin') {
                adminModSection.classList.remove('hidden');
                adminLink.classList.remove('hidden');
                moderatorLink.classList.remove('hidden');
            } else if (role === 'moderator') {
                adminModSection.classList.remove('hidden');
                adminLink.classList.add('hidden');
                moderatorLink.classList.remove('hidden');
            } else {
                adminModSection.classList.add('hidden');
                adminLink.classList.add('hidden');
                moderatorLink.classList.add('hidden');
            }
        };

        /**
         * trustScore-‡¶ï‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡ßç‡¶ï‡ßá‡¶≤ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡ß´-‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ï‡ßá‡¶≤‡ßá ‡¶∞‡ßÇ‡¶™‡¶æ‡¶®‡ßç‡¶§‡¶∞ ‡¶ï‡¶∞‡ßá‡•§
         * 20 = 1 Star, 40 = 2 Stars, 60 = 3 Stars, 80 = 4 Stars, 100 = 5 Stars
         * @param {number} rawScore - ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶ú‡ßá‡¶∞ raw trustScore.
         * @returns {number} - ‡ß´-‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç (‡ß¶.‡ß¶ ‡¶•‡ßá‡¶ï‡ßá ‡ß´.‡ß¶)‡•§
         */
        function mapScoreToFiveStarRating(rawScore) {
            const score = rawScore || 0;
            const step = 20; // ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡ß®‡ß¶ ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü
            const maxScore = 100;
            const minRating = 1.0;
            const maxRating = 5.0;

            if (score <= 20) return minRating;
            if (score >= maxScore) return maxRating;

            // 20 ‡¶•‡ßá‡¶ï‡ßá 100 ‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶∏‡ßç‡¶ï‡ßã‡¶∞‡¶ï‡ßá 1.0 ‡¶•‡ßá‡¶ï‡ßá 5.0 ‡¶è ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ï‡¶∞‡¶æ
            // 20 (1 star) ‡¶•‡ßá‡¶ï‡ßá 100 (5 stars) ‡¶è‡¶∞ ‡¶∞‡ßá‡¶û‡ßç‡¶ú
            const normalizedScore = (score - 20) / (maxScore - 20); // 0 ‡¶•‡ßá‡¶ï‡ßá 1.0
            let rating = normalizedScore * (maxRating - minRating) + minRating;

            // 0.5 ‡¶∏‡ßç‡¶ü‡ßá‡¶™‡ßá ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡¶ï‡¶∞‡¶æ
            rating = Math.round(rating * 2) / 2;
            
            return parseFloat(rating.toFixed(1));
        }


        // üî• ‡¶®‡¶§‡ßÅ‡¶®: ‡¶õ‡ßã‡¶ü ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá
        const renderSmallStarRating = (score) => {
            const roundedScore = Math.round(score * 2) / 2; 
            let html = '';
            for (let i = 1; i <= 5; i++) {
                if (roundedScore >= i) {
                    html += `<i class="fas fa-star small-star filled-star"></i>`;
                } else if (roundedScore === i - 0.5) {
                    html += `<i class="fas fa-star-half-alt small-star filled-star"></i>`;
                } else {
                    html += `<i class="far fa-star small-star filled-star empty-star"></i>`;
                }
            }
            return html;
        };
        
        // ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≠‡¶æ‡¶ü‡¶æ‡¶∞ HTML ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        const getOwnerInfoHtml = (ownerId) => {
            const profile = userProfileCache[ownerId] || {};
            const name = profile.facebookName || '‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞';
            const photoUrl = profile.profilePhotoUrl;
            
            // üî• ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®: trustScore ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ
            const rawtrustScore = profile.trustScore || 0; 
            
            // üî• ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®: ‡¶®‡¶§‡ßÅ‡¶® ‡¶≤‡¶ú‡¶ø‡¶ï ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶ó‡¶£‡¶®‡¶æ
            const ratingScore = mapScoreToFiveStarRating(rawtrustScore); 
            const ratingHtml = renderSmallStarRating(ratingScore);
            
            const initial = name.charAt(0).toUpperCase();
            
            // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≠‡¶æ‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞
            let avatarHtml;
            if (photoUrl) {
                avatarHtml = `<img src="${photoUrl}" alt="${name}" class="w-full h-full object-cover">`;
            } else {
                // ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≠‡¶æ‡¶ü‡¶æ‡¶∞ (‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞)
                avatarHtml = `<span class="text-xs">${initial}</span>`;
            }
            
            return `
                <div class="flex items-center space-x-2">
                    <div class="small-avatar">
                        ${avatarHtml}
                    </div>
                    <div>
                        <span class="text-sm font-semibold text-gray-800">${name}</span>
                        <!-- ‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶æ‡¶∏‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø‡¶§‡¶æ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶¨‡¶æ‡¶∞ -->
                        <div class="small-rating-bar">
                            ${ratingHtml}
                            <span class="text-xs text-gray-500 ml-1">(${ratingScore.toFixed(1)})</span>
                        </div>
                    </div>
                </div>
            `;
        };
        
        // üî• ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (trustScore ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã)
        const cacheUserProfiles = async (userIds) => {
            const usersToFetch = Array.from(userIds).filter(id => id && !userProfileCache[id]);

            for (const id of usersToFetch) {
                try {
                    const snapshot = await get(ref(rtdb, `users/${id}`));
                    const userData = snapshot.val();
                    if (userData) {
                        // ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡ßá‡¶ü‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá
                        userProfileCache[id] = {
                            facebookName: userData.facebookName || '‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ',
                            profilePhotoUrl: userData.profilePhotoUrl || null,
                            trustScore: userData.trustScore || userData.trustScore || 0, 
                            role: userData.role || 'user'
                        };
                    } else {
                        userProfileCache[id] = {
                            facebookName: `‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ${id.substring(0, 4)}...`,
                            profilePhotoUrl: null,
                            trustScore: 0,
                            role: 'user'
                        };
                    }
                } catch (error) {
                    console.error(`Error fetching user ${id}:`, error);
                    userProfileCache[id] = {
                         facebookName: `‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ${id.substring(0, 4)}... (‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø)`,
                         profilePhotoUrl: null,
                         trustScore: 0,
                         role: 'user'
                    };
                }
            }
        };

        // Cloudinary ‡¶§‡ßá ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶°‡ßá‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (profile.html ‡¶•‡ßá‡¶ï‡ßá ‡¶Ü‡¶®‡¶æ)
        async function uploadToCloudinary(file) {
            if (!file) return null;

            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);
            // ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ ‡¶´‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
            formData.append('folder', `task_proofs/${userId}`); 

            try {
                showNotification("‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", 'info');
                const response = await fetch(CLOUDINARY_URL, {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error("Cloudinary Error:", errorData);
                    throw new Error(`Cloudinary ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•: ${errorData.error.message || response.statusText}`);
                }

                const data = await response.json();
                showNotification("‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!", 'success');
                return data.secure_url; // ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶õ‡¶¨‡¶ø‡¶∞ URL
            } catch (error) {
                console.error("Error during Cloudinary upload:", error);
                showNotification(`‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§`, 'error');
                throw error; 
            }
        }
        
        /**
         * ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶â‡¶ö‡ßç‡¶ö‡¶§‡¶æ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶® ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßá‡•§
         * ‡¶è‡¶ü‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßá ‡¶Ø‡ßá ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶®‡¶ø‡¶ö‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶¨‡ßá‡•§
         */
        const updateMainContentMargin = () => {
            const headerHeight = appHeader.offsetHeight || 64; // h-16 = 4rem = 64px
            const defaultSpacing = 8; // mt-2 (0.5rem)
            
            let requiredMargin = headerHeight + defaultSpacing; 
            
            if (!trustNoticeBoard.classList.contains('hidden')) {
                const noticeHeight = trustNoticeBoard.offsetHeight; 
                requiredMargin = headerHeight + noticeHeight + 16; // 16px = 1rem (‡¶Ü‡¶∞‡ßã ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶®‡¶ø‡¶ö‡ßá ‡¶®‡¶æ‡¶Æ‡¶æ‡¶®‡ßã)
            }
            
            // Tailwind utilities ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶®‡¶æ ‡¶ï‡¶∞‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø style.marginTop ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
            mainContentContainer.style.marginTop = `${requiredMargin / 16}rem`; // px ‡¶ï‡ßá rem ‡¶è ‡¶ï‡¶®‡¶≠‡¶æ‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ

            // ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶® ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶≤‡ßã‡¶°‡¶æ‡¶∞‡¶ï‡ßá ‡¶≤‡ßÅ‡¶ï‡¶ø‡¶Ø‡¶º‡ßá ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
            showContentAndHideLoader();
        };

        // üî• ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡¶∂‡¶® ‡¶Æ‡¶°‡¶æ‡¶≤‡ßá‡¶∞ ‡¶≤‡¶ú‡¶ø‡¶ï ‡¶è‡¶ñ‡¶® ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá
        const checkSuspensionStatus = (uid) => {
            const suspensionRef = ref(rtdb, `users/${uid}/suspension`);
            
            const contentElements = [mainContentContainer, appHeader];
            
            onValue(suspensionRef, (snapshot) => {
                const suspensionData = snapshot.val();
                const now = Date.now();

                // ------------------------------------------
                // ‡ßß. ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡¶∂‡¶® ‡¶ö‡ßá‡¶ï ‡¶≤‡¶ú‡¶ø‡¶ï
                // ------------------------------------------
                if (suspensionData && suspensionData.suspendUntil > now) {
                    // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡ßç‡¶° ‡¶Ü‡¶õ‡ßá
                    
                    // a) UI ‡¶¨‡ßç‡¶≤‡¶ï‡¶ø‡¶Ç: ‡¶™‡ßÅ‡¶∞‡ßã ‡¶™‡ßá‡¶ú ‡¶¨‡ßç‡¶≤‡¶æ‡¶∞ ‡¶ì ‡¶¨‡ßç‡¶≤‡¶ï ‡¶ï‡¶∞‡¶æ
                    contentElements.forEach(el => el.classList.add('content-suspended'));
                    
                    // b) ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶°‡¶ï‡ßá ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡¶∂‡¶® ‡¶Æ‡ßã‡¶°‡ßá ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
                    trustNoticeBoard.classList.remove('hidden');
                    trustNoticeBoard.classList.add('suspended-mode');

                    // c) ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡¶∂‡¶® ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
                    noticeMessage.innerHTML = `<i class="fas fa-ban mr-2"></i> **‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶Æ‡¶Ø‡¶º‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡ßç‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!**`;
                    suspensionDetails.classList.remove('hidden');

                    suspendReasonDisplay.textContent = suspensionData.reason || '‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡ßü‡¶®‡¶ø‡•§';
                    
                    // d) ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶® ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶æ
                    startSuspensionCountdown(suspensionData.suspendUntil);
                    
                } else {
                    // ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡ßç‡¶° ‡¶®‡ßá‡¶á ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶Æ‡ßá‡¶Ø‡¶º‡¶æ‡¶¶ ‡¶∂‡ßá‡¶∑
                    
                    // a) UI ‡¶Ü‡¶®‡¶¨‡ßç‡¶≤‡¶ï ‡¶ï‡¶∞‡¶æ
                    contentElements.forEach(el => el.classList.remove('content-suspended'));
                    
                    // b) ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶® ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ
                    if (countdownInterval) {
                        clearInterval(countdownInterval);
                        countdownInterval = null;
                    }

                    if (suspensionData && suspensionData.suspendUntil < now) {
                        // ‡¶Æ‡ßá‡¶Ø‡¶º‡¶æ‡¶¶ ‡¶∂‡ßá‡¶∑ ‡¶π‡¶≤‡ßá ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶•‡ßá‡¶ï‡ßá ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ
                        set(suspensionRef, null).catch(e => console.error("Error clearing suspension:", e));
                    }
                    
                    // c) ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶°‡¶ï‡ßá ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ü‡ßç‡¶∞‡¶æ‡¶∏‡ßç‡¶ü ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ ‡¶Æ‡ßã‡¶°‡ßá ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
                    trustNoticeBoard.classList.remove('suspended-mode');
                    suspensionDetails.classList.add('hidden');
                    
                    // d) ‡¶ü‡ßç‡¶∞‡¶æ‡¶∏‡ßç‡¶ü ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶ö‡ßá‡¶ï (‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶∞)
                    if (currentUserData.trustScore < 100) {
                        trustNoticeBoard.classList.remove('hidden');
                        noticeMessage.innerHTML = `<i class="fas fa-exclamation-triangle mr-2"></i> ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ trust Score ‡¶ï‡¶Æ‡•§ ‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶®‡¶æ‡¶π‡¶≤‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡ßç‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá‡•§`;
                    } else {
                        trustNoticeBoard.classList.add('hidden');
                    }
                }
                
                // üî• ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡¶∂‡¶® ‡¶≤‡¶ú‡¶ø‡¶ï ‡¶∂‡ßá‡¶∑ ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
                updateMainContentMargin();

            });
        };


        onAuthStateChanged(auth, async (user) => {
            if (user) {
                userId = user.uid;
                
                // üî•üî• ‡¶∏‡ßç‡¶ü‡ßá‡¶™ ‡ß©: ‡¶∏‡¶æ‡¶∏‡¶™‡ßá‡¶®‡¶∂‡¶® ‡¶∏‡ßç‡¶ü‡ßá‡¶ü ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ï‡ßã‡¶° ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§
                checkSuspensionStatus(user.uid); 
                // ******************************************************
                
                const userRef = ref(rtdb, `users/${userId}`);
                onValue(userRef, async (snapshot) => {
                    const userData = snapshot.val() || {};
                    currentUserData = userData; // üî• ‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶¨‡¶≤‡ßá ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£
                    
                    if (snapshot.val() === null) {
                        const initialUserData = {
                            points: 0,
                            facebookName: '‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ',
                            tasksCreated: 0,
                            tasksCompleted: 0,
                            tasksRejected: 0,
                            createdAt: Date.now(),
                            lastFacebookName: '',
                            role: 'user', 
                            trustScore: 0 
                        };
                        try {
                            await set(userRef, initialUserData);
                            return; 
                        } catch (e) {
                            console.error("User initialization failed:", e);
                            showNotification('‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶°‡ßá‡¶ü‡¶æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá‡•§', 'error');
                        }
                    }

                    currentUserPoints = userData.points || 0; 
                    currentUserName = userData.facebookName || '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ';
                    userCompletedTasks = userData.completedTasks || {};
                    lastFacebookName = userData.lastFacebookName || '';
                    
                    const userRole = userData.role || 'user'; 
                    const usertrustScore = userData.trustScore || 0; 

                    // ** ‡¶ü‡ßç‡¶∞‡¶æ‡¶∏‡ßç‡¶ü ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã/‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã‡¶∞ ‡¶≤‡¶ú‡¶ø‡¶ï **
                    // üî• ‡¶è‡¶á ‡¶¨‡ßç‡¶≤‡¶ï‡¶ü‡¶ø ‡¶è‡¶ñ‡¶® `checkSuspensionStatus` ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡ßá‡¶∞ `else` ‡¶¨‡ßç‡¶≤‡¶ï‡ßá ‡¶ö‡¶≤‡ßá ‡¶ó‡ßá‡¶õ‡ßá‡•§ 
                    // ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶∂‡ßÅ‡¶ß‡ßÅ `checkSuspensionStatus` ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã ‡¶Ø‡¶æ‡¶§‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ì‡ßü‡¶æ‡¶∞ ‡¶™‡¶∞‡ßá ‡¶ü‡ßç‡¶∞‡¶æ‡¶∏‡ßç‡¶ü ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ ‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡ßü‡•§
                    checkSuspensionStatus(user.uid);
                    // ******************************************************


                    updateDashboardLinks(userRole); 
                    
                    // ‡¶è‡¶ñ‡¶æ‡¶®‡ßá formatPoints ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá
                    document.getElementById('user-points').textContent = formatPoints(currentUserPoints);
                    document.getElementById('total-points').textContent = formatPoints(currentUserPoints);
                    document.getElementById('total-tasks-created').textContent = formatPoints(userData.tasksCreated || 0);
                    document.getElementById('total-tasks-completed').textContent = formatPoints(userData.tasksCompleted || 0);
                    document.getElementById('total-tasks-rejected').textContent = formatPoints(userData.tasksRejected || 0);
                    document.getElementById('user-name-display').textContent = currentUserName;
                    document.getElementById('user-id-display').textContent = user.uid;
                    
                    const profileAvatar = document.getElementById('profile-avatar');
                    profileAvatar.innerHTML = '';
                    if (userData.profilePhotoUrl) {
                        const img = document.createElement('img');
                        img.src = userData.profilePhotoUrl;
                        img.alt = userData.facebookName || '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ';
                        img.className = 'w-full h-full object-cover rounded-full';
                        profileAvatar.appendChild(img);
                    } else if (userData.facebookName) {
                        profileAvatar.textContent = userData.facebookName.charAt(0).toUpperCase();
                    }
                    
                    // ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶≤‡¶ø‡¶∏‡ßá‡¶®‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
                    listenForTasks(); 
                });
                
            } else {
                try {
                    await setPersistence(auth, browserSessionPersistence);
                    const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                    if (initialAuthToken) {
                        await signInWithCustomToken(auth, initialAuthToken);
                    } else {
                        await signInAnonymously(auth);
                    }
                } catch (error) {
                    console.error("Authentication failed:", error);
                    showNotification('‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá‡•§ ‡¶™‡ßá‡¶ú‡¶ü‡¶ø ‡¶∞‡¶ø‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
                    updateMainContentMargin(); // ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡¶≤‡ßá‡¶ì ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶® ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
                }
            }
        });
        
        /**
         * ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶™‡ßç‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡¶® ‡¶ï‡¶∞‡ßá‡•§
         * @param {Array<Object>} proofs - ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ‡•§
         */
        const displaySubmittedProofs = (proofs) => {
            const submittedProofsList = document.getElementById('submitted-proofs-list');
            submittedProofsList.innerHTML = ''; // ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶™‡¶∞‡¶ø‡¶∑‡ßç‡¶ï‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ

            if (proofs.length === 0) {
                submittedProofsList.innerHTML = '<div class="text-center py-6 text-gray-500">‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶®‡¶®‡¶ø‡•§</div>';
                return;
            }

            proofs.forEach(proof => {
                // üî• ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§ ‡¶°‡¶ø‡¶∏‡¶™‡ßç‡¶≤‡ßá: ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â‡¶Ø‡¶º‡¶æ‡¶∞‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                const reviewerProfile = userProfileCache[proof.reviewedBy];
                
                let reviewerDisplay;
                if (proof.reviewedBy) {
                    const name = reviewerProfile ? reviewerProfile.facebookName || '‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ' : '‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ';
                    const role = reviewerProfile ? reviewerProfile.role : 'owner'; // ‡¶Ø‡¶¶‡¶ø ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡¶æ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü, ‡¶ß‡¶∞‡ßá ‡¶®‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡¶≤‡ßã ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï
                    const roleTag = role === 'admin' ? ' (‡¶è‡¶°‡¶Æ‡¶ø‡¶®)' : (role === 'moderator' ? ' (‡¶Æ‡¶°‡¶æ‡¶∞‡ßá‡¶ü‡¶∞)' : ' (‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï)');
                    reviewerDisplay = `<p class="text-xs text-gray-600 mt-1"><i class="fas fa-user-shield mr-1 text-indigo-500"></i> ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®: <span class="font-semibold">${name}</span>${roleTag}</p>`;
                } else {
                    reviewerDisplay = `<p class="text-xs text-gray-600 mt-1"><i class="fas fa-user-shield mr-1 text-indigo-500"></i> ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â: <span class="font-semibold">‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶õ‡ßá</span></p>`;
                }
                
                // üî• ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶°‡¶ø‡¶∏‡¶™‡ßç‡¶≤‡ßá ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ
                let statusInfo = '';
                let borderColor = 'border-yellow-500';

                if (proof.status === 'approved') {
                    borderColor = 'border-green-500';
                    statusInfo = `<span class="font-bold text-green-700">+${formatPoints(proof.pointsPerTask)} ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü</span>`;
                } else if (proof.status === 'rejected') {
                    borderColor = 'border-red-500';
                    statusInfo = `<span class="font-bold text-red-700">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</span>`;
                } else {
                    statusInfo = `<span class="font-bold text-yellow-700">‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶ö‡¶≤‡¶õ‡ßá</span>`;
                }
                
                // ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤‡ßá‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶Ø‡¶¶‡¶ø ‡¶•‡¶æ‡¶ï‡ßá
                const rejectionReasonHtml = proof.status === 'rejected' && proof.rejectionReason 
                    ? `<div class="bg-red-50 p-3 rounded-lg mt-3 text-red-700 border-l-4 border-red-400 text-xs">
                         <i class="fas fa-exclamation-triangle mr-1"></i> 
                         <span class="font-bold">‡¶ï‡¶æ‡¶∞‡¶£:</span> ${proof.rejectionReason}
                       </div>`
                    : '';

                // üî• ‡¶ï‡¶æ‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá
                const card = `
                    <div class="app-card p-4 border-l-4 ${borderColor}">
                        
                        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                            
                            <!-- ‡¶¨‡¶æ‡¶Æ ‡¶™‡¶æ‡¶∂: ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ü‡¶æ‡¶á‡¶™, ‡¶®‡¶æ‡¶Æ ‡¶ì ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßü -->
                            <div class="space-y-1 mb-3 sm:mb-0">
                                <div class="flex items-center space-x-2">
                                    ${getTaskTypeBadge(proof.taskType)}
                                    <span class="text-lg font-bold text-gray-800">${proof.taskType}</span>
                                </div>
                                <p class="text-xs text-gray-500">
                                    <i class="fas fa-user-circle mr-1"></i> 
                                    ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶®‡¶æ‡¶Æ: <span class="font-semibold text-gray-700">${proof.facebookName}</span>
                                </p>
                                <p class="text-xs text-gray-500">
                                    <i class="fas fa-clock mr-1"></i> 
                                    ‡¶∏‡¶Æ‡¶Ø‡¶º: ${formatDate(proof.submittedAt)}
                                </p>
                                ${reviewerDisplay} 
                            </div>

                            <!-- ‡¶°‡¶æ‡¶® ‡¶™‡¶æ‡¶∂: ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶ì ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü -->
                            <div class="text-right flex flex-col items-end space-y-1">
                                ${statusInfo}
                                <!-- üî• ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®: ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶¨‡¶æ‡¶ü‡¶® ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá‡¶õ‡ßá, ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â‡ßü‡¶æ‡¶∞‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá -->
                                <!-- <a href="${proof.screenshotUrl || proof.taskLink}" target="_blank" class="brand-blue-text hover:underline text-xs flex items-center">
                                    <i class="fas fa-image mr-1"></i> ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
                                </a> -->
                            </div>
                        </div>
                        
                        ${rejectionReasonHtml}
                    </div>
                `;
                submittedProofsList.insertAdjacentHTML('beforeend', card);
            });
        };


        const listenForTasks = () => {
            if (!userId) return;

            const tasksRef = ref(rtdb, `tasks`);
            
            // üî• ‡¶™‡ßç‡¶∞‡ßÅ‡¶´‡ßá‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶π‡¶≤‡ßá‡¶ì ‡¶è‡¶á ‡¶≤‡¶ø‡¶∏‡ßá‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶π‡¶¨‡ßá, ‡¶§‡¶æ‡¶á ‡¶ü‡ßç‡¶∞‡¶æ‡¶∏‡ßç‡¶ü ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá
            onValue(tasksRef, async (snapshot) => { 
                const allTasks = snapshot.val() || {};
                const availableTasks = [];
                const submittedProofs = [];
                const requiredUserIds = new Set(); // üî• ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡ßá‡¶ü: ‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï ‡¶ì ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â‡¶Ø‡¶º‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡¶æ
                
                for (const taskId in allTasks) {
                    const task = allTasks[taskId];
                    if (task && task.ownerId) { 
                        
                        // üî• ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï‡ßá‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡¶æ
                        requiredUserIds.add(task.ownerId);

                        const userStatus = userCompletedTasks[taskId];
                        
                        if (task.ownerId !== userId) {
                            
                            let pendingProofCount = 0; 
                            
                            if (task.proofs) {
                                for (const proofId in task.proofs) {
                                    const proof = task.proofs[proofId];
                                    
                                    if (proof.status === 'pending') {
                                        pendingProofCount++; 
                                    }
                                    
                                    if (proof.userId === userId) {
                                        submittedProofs.push({
                                            proofId: proofId,
                                            taskId: taskId,
                                            taskType: task.taskType,
                                            taskLink: task.taskLink,
                                            pointsPerTask: task.pointsPerTask,
                                            ...proof
                                        });
                                        // üî• ‡¶Ø‡¶¶‡¶ø ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶π‡¶Ø‡¶º‡ßá ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â‡¶Ø‡¶º‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡¶æ
                                        if (proof.reviewedBy) {
                                            requiredUserIds.add(proof.reviewedBy);
                                        }
                                    }
                                }
                            }

                            // Old logic for available tasks 
                            let statusToDisplay = userStatus || 'available'; // available or pending

                            if (task.proofs) {
                                const userProofs = Object.keys(task.proofs)
                                    .map(proofId => ({ id: proofId, ...task.proofs[proofId] }))
                                    .filter(p => p.userId === userId)
                                    .sort((a, b) => b.submittedAt - a.submittedAt); 

                                const latestProof = userProofs[0];

                                if(latestProof) {
                                    statusToDisplay = latestProof.status;
                                }
                            }
                            
                            // üî• ‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ ‡¶§‡¶æ ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶≤‡¶ú‡¶ø‡¶ï:
                            const approvedCount = task.completedCount || 0;
                            const totalProofCount = approvedCount + pendingProofCount;
                            const isTargetReached = totalProofCount >= task.quantity;
                            
                            // ‡¶∂‡¶∞‡ßç‡¶§: ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá AND ‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶®‡¶æ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá AND (‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶π‡¶Ø‡¶º ‡¶∞‡¶ø‡¶ú‡ßá‡¶ï‡ßç‡¶ü ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá OR ‡¶è‡¶ñ‡¶®‡ßã ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßá‡¶®‡¶ø)
                            if (task.status === 'active' && !isTargetReached && (statusToDisplay === 'rejected' || statusToDisplay === 'available')) {
                                availableTasks.push({ id: taskId, ...task });
                            }
                            
                            // pending ‡¶¨‡¶æ approved ‡¶π‡¶≤‡ßá, ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï‡¶ü‡¶ø ‡¶Ü‡¶∞ Available ‡¶∏‡ßá‡¶ï‡¶∂‡¶®‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá ‡¶®‡¶æ (‡¶ï‡¶æ‡¶∞‡¶£ statusToDisplay 'rejected' ‡¶¨‡¶æ 'available' ‡¶®‡¶Ø‡¶º)
                        }
                    }
                }

                // üî• ‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï ‡¶ì ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â‡¶Ø‡¶º‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶ï‡¶∞‡¶æ
                await cacheUserProfiles(requiredUserIds);
                
                // Sort submitted proofs by submission time (latest first)
                submittedProofs.sort((a, b) => b.submittedAt - a.submittedAt); 
                
                displayAvailableTasks(availableTasks);
                displaySubmittedProofs(submittedProofs); 
            });
        };

        const displayAvailableTasks = (tasks) => {
            availableTasksGrid.innerHTML = '';
            if (tasks.length === 0) {
                availableTasksGrid.innerHTML = '<div class="col-span-full text-center py-12 text-gray-500 text-lg">‚ú® ‡¶è‡¶ñ‡¶® ‡¶ï‡ßã‡¶®‡ßã ‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß ‡¶ï‡¶æ‡¶ú ‡¶®‡ßá‡¶á‡•§ ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</div>';
                return;
            }

            tasks.forEach(task => {
                const completedCount = task.completedCount || 0; 
                
                // üî• ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                const ownerInfoHtml = getOwnerInfoHtml(task.ownerId);

                const taskCard = `
                    <div class="app-card p-5">
                        
                        <!-- ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ, ‡¶õ‡¶¨‡¶ø ‡¶ì ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç -->
                        <div class="mb-3 pb-3 border-b border-gray-100">
                            ${ownerInfoHtml}
                        </div>
                        
                        <div class="flex justify-between items-start mb-4">
                            ${getTaskTypeBadge(task.taskType)}
                            <div class="bg-gradient-to-r from-green-400 to-green-600 text-white font-bold px-3 py-1 rounded-full text-sm shadow-md">
                                + ${formatPoints(task.pointsPerTask)} ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü
                            </div>
                        </div>
                        <h4 class="text-xl font-semibold text-gray-800 mb-4">${task.taskType} ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®</h4>
                        <div class="space-y-2 text-sm text-gray-600 mb-6">
                            <p class="flex justify-between items-center">
                                <span><i class="fas fa-bullseye text-blue-500 mr-2"></i> ‡¶Æ‡ßã‡¶ü ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø:</span> 
                                <span class="font-bold text-base">${formatPoints(task.quantity)} ‡¶ü‡¶ø</span>
                            </p>
                            <p class="flex justify-between items-center">
                                <span><i class="fas fa-check-double text-green-500 mr-2"></i> ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá:</span> 
                                <span class="font-bold text-base text-green-600">${formatPoints(completedCount)} ‡¶ü‡¶ø</span>
                            </p>
                            <div class="pt-3 border-t border-gray-100">
                                <span class="block mb-1 text-gray-500 font-medium text-xs">‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶≤‡¶ø‡¶Ç‡¶ï:</span> 
                                <a href="${task.taskLink}" target="_blank" class="brand-blue-text hover:underline text-sm break-all font-mono">${task.taskLink}</a>
                            </div>
                        </div>
                        <button class="w-full brand-blue text-white py-2.5 px-4 text-base font-bold rounded-lg hover:brightness-110 shadow-md" onclick="openSubmitProofModal('${task.id}')">
                            <i class="fas fa-hand-pointer mr-2"></i> ‡¶ï‡¶æ‡¶ú‡¶ü‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®
                        </button>
                    </div>
                `;
                availableTasksGrid.insertAdjacentHTML('beforeend', taskCard);
            });
        };

        window.openSubmitProofModal = (taskId) => {
            currentTaskId = taskId;
            
            // ‡¶∂‡ßá‡¶∑‡¶¨‡¶æ‡¶∞ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶°‡ßá‡¶ü‡¶æ ‡¶¶‡¶ø‡ßü‡ßá ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶´‡¶ø‡¶≤‡ßç‡¶°‡¶ó‡ßÅ‡¶≤‡ßã ‡¶∏‡ßç‡¶¨‡ßü‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡ßü‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá
            document.getElementById('facebookName').value = lastFacebookName;
            
            // ‡¶´‡¶æ‡¶á‡¶≤ ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
            document.getElementById('screenshotFile').value = '';
            
            submitProofModal.classList.remove('hidden');
        };

        submitProofForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const submitButton = submitProofForm.querySelector('button[type="submit"]');
            submitButton.disabled = true;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';

            const facebookName = document.getElementById('facebookName').value.trim();
            const screenshotInput = document.getElementById('screenshotFile');
            const screenshotFile = screenshotInput.files[0];
            
            // ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            if (!facebookName || !screenshotFile) {
                showNotification('‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï ‡¶Ü‡¶á‡¶°‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§', 'error');
                submitButton.disabled = false;
                submitButton.innerHTML = '<i class="fas fa-upload mr-2"></i> ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®';
                return;
            }

            if (!currentTaskId || !userId) {
                showNotification('‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ‡¶ï‡¶æ‡¶ú ‡¶¨‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§', 'error');
                submitButton.disabled = false;
                submitButton.innerHTML = '<i class="fas fa-upload mr-2"></i> ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®';
                return;
            }
            
            let screenshotUrl = ''; // Cloudinary URL ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

            try {
                // üî• Cloudinary ‡¶§‡ßá ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
                screenshotUrl = await uploadToCloudinary(screenshotFile);

                if (!screenshotUrl) {
                    throw new Error("Cloudinary ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡ßã‡¶®‡ßã URL ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§");
                }
                
                const proofRef = ref(rtdb, `tasks/${currentTaskId}/proofs`);
                
                // proofData ‡¶§‡ßá screenshotUrl ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                const proofData = {
                    userId: userId,
                    userName: currentUserName,
                    facebookName: facebookName, 
                    screenshotUrl: screenshotUrl, // üî• ‡¶®‡¶§‡ßÅ‡¶®: URL ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                    submittedAt: Date.now(), 
                    status: 'pending' 
                };

                const userCompletedTaskRef = ref(rtdb, `users/${userId}/completedTasks/${currentTaskId}`);
                await set(userCompletedTaskRef, 'pending');
                
                await push(proofRef, proofData);

                // *** ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ú‡¶®: ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤‡ßá ‡¶∂‡ßá‡¶∑ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ***
                const userUpdateRef = ref(rtdb, `users/${userId}`);
                await update(userUpdateRef, {
                    lastFacebookName: facebookName,
                });
                // *******************************************************************

                showNotification('‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá! ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶ï‡¶∞‡¶¨‡ßá‡•§', 'success');
                submitProofForm.reset();
                closeModal('submit-proof-modal');

            } catch (error) {
                console.error("Proof submission failed:", error);
                // Cloudinary error already handled by showNotification inside uploadToCloudinary
                if (!error.message.includes('Cloudinary')) { 
                    showNotification(`‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•: ${error.message}`, 'error');
                }
            } finally {
                submitButton.disabled = false;
                submitButton.innerHTML = '<i class="fas fa-upload mr-2"></i> ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®';
            }
        });

        window.logout = logout;
        window.closeModal = (modalId) => {
            document.getElementById(modalId).classList.add('hidden');
        };

        window.onclick = function(event) {
            if (event.target === submitProofModal) {
                submitProofModal.classList.add('hidden');
            }
        };
    </script>
</body>
</html>

