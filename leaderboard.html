<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶® ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°</title>
    <script src="https://cdn.tailwindcss.com"> </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* ‡¶´‡¶®‡ßç‡¶ü ‡¶ì ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶ó‡ßç‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶® */
        body {
            font-family: 'Hind Siliguri', Inter, sans-serif;
            background-color: #f7f9fc;
            min-height: 100vh;
        }

        /* ‡¶¨‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶ï‡¶æ‡¶≤‡¶æ‡¶∞ - ‡¶Ü‡¶ß‡ßÅ‡¶®‡¶ø‡¶ï ‡¶®‡ßÄ‡¶≤ */
        .brand-blue {
            background-color: #0d6efd;
            transition: background-color 0.2s;
        }
        
        .brand-blue:hover {
            background-color: #0b5ed7;
        }

        .brand-blue-text {
            color: #0d6efd;
        }

        /* ‡¶ï‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ - ‡¶è‡¶≤‡¶ø‡¶≠‡ßá‡¶ü‡ßá‡¶° ‡¶≤‡ßÅ‡¶ï */
        .app-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            border: 1px solid #e9ecef;
            transition: box-shadow 0.3s, transform 0.2s;
        }

        .app-card:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            transform: translateY(-1px);
        }

        /* ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            border-radius: 8px;
            transition: all 0.2s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .leaderboard-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
        }

        .leaderboard-item.first {
            background-color: #FFD700; /* Gold */
            color: #8B4513; /* SaddleBrown */
            font-weight: 700;
        }
        
        .leaderboard-item.second {
            background-color: #C0C0C0; /* Silver */
            color: #495057;
        }
        
        .leaderboard-item.third {
            background-color: #CD7F32; /* Bronze */
            color: #FFF;
        }
        
        /* ‡¶Æ‡ßá‡¶°‡ßá‡¶≤ ‡¶Ü‡¶á‡¶ï‡¶® ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
        .medal-icon {
            font-size: 1.5rem;
            margin-right: 0.75rem;
        }
        
        /* üî• ‡¶®‡¶§‡ßÅ‡¶®: ‡¶õ‡ßã‡¶ü ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ (‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶æ‡¶∏‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø‡¶§‡¶æ) */
        .small-rating-bar {
            display: flex;
            align-items: center;
            gap: 2px;
        }
        .small-star {
            font-size: 0.75rem; /* ‡¶õ‡ßã‡¶ü ‡¶Ü‡¶ï‡¶æ‡¶∞ */
        }
        .filled-star {
            color: #ffc107; /* ‡¶∏‡ßã‡¶®‡¶æ‡¶≤‡ßÄ ‡¶∞‡¶Ç */
        }

        .empty-star {
            color: #e9ecef; /* ‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶§‡¶æ‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶π‡¶æ‡¶≤‡¶ï‡¶æ ‡¶ß‡ßÇ‡¶∏‡¶∞ */
        }
        /* üî• ‡¶õ‡ßã‡¶ü ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ ‡¶∂‡ßá‡¶∑ */
    </style>
</head>
<body class="p-4 flex flex-col items-center justify-center">

    <div class="container max-w-2xl w-full">
        
        <header class="app-card p-6 text-center mb-6 md:mb-8">
            <h1 class="text-3xl md:text-4xl font-extrabold text-gray-800 flex items-center justify-center gap-4">
                <i class="fas fa-crown text-yellow-500 text-3xl md:text-4xl"></i>
                ‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶æ‡¶∏‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø‡¶§‡¶æ ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°
                <i class="fas fa-trophy text-blue-500 text-3xl md:text-4xl"></i>
            </h1>
            <!-- üî• ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®: ‡¶∞‡ßç‡¶Ø‡¶æ‡¶ô‡ßç‡¶ï‡¶ø‡¶Ç ‡¶≤‡¶ú‡¶ø‡¶ï ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã -->
            <p class="text-sm text-gray-500 mt-2">‡¶∞‡ßç‡¶Ø‡¶æ‡¶ô‡ßç‡¶ï‡¶ø‡¶Ç: ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶ü‡ßç‡¶∞‡¶æ‡¶∏‡ßç‡¶ü ‡¶∏‡ßç‡¶ï‡ßã‡¶∞‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá (‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶æ‡¶∏‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø‡¶§‡¶æ)</p>
        </header>

        <main class="app-card p-4 md:p-6">
            <h2 class="text-2xl font-bold text-gray-700 mb-6 text-center border-b pb-4">‡¶∂‡ßÄ‡¶∞‡ßç‡¶∑ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶ó‡¶£</h2>
            <ul class="space-y-4" id="leaderboard-list">
                <!-- ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶≤‡ßã‡¶° ‡¶π‡¶¨‡ßá -->
                <li class="text-center py-6 text-gray-500 text-lg" id="loading-message">‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</li>
            </ul>
        </main>

        <div class="mt-8 text-center">
            <a href="index.html" class="inline-flex items-center brand-blue text-white font-bold py-3 px-6 rounded-full shadow-lg hover:shadow-xl transition-all duration-300">
                <i class="fas fa-arrow-left mr-2"></i>
                ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®
            </a>
        </div>

    </div>

    <script type="module">
        // Firebase Realtime Database Imports
        import { rtdb, ref, onValue } from "./rtdb-config.js";
        
        // ======================================================================
        // üî• ‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶æ‡¶∏‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø‡¶§‡¶æ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶ó‡¶£‡¶®‡¶æ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        // ======================================================================
        /**
         * trustScore-‡¶ï‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡ßç‡¶ï‡ßá‡¶≤ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡ß´-‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ï‡ßá‡¶≤‡ßá ‡¶∞‡ßÇ‡¶™‡¶æ‡¶®‡ßç‡¶§‡¶∞ ‡¶ï‡¶∞‡ßá‡•§
         * 20 = 1 Star, 40 = 2 Stars, 60 = 3 Stars, 80 = 4 Stars, 100 = 5 Stars
         * @param {number} rawScore - ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶ú‡ßá‡¶∞ raw trustScore.
         * @returns {number} - ‡ß´-‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç (‡ß¶.‡ß¶ ‡¶•‡ßá‡¶ï‡ßá ‡ß´.‡ß¶)‡•§
         */
        function mapScoreToFiveStarRating(rawScore) {
            const score = rawScore || 0;
            const step = 20; // ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡ß®‡ß¶ ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü
            const maxScore = 100;
            const minRating = 1.0;
            const maxRating = 5.0;

            if (score <= 20) return minRating;
            if (score >= maxScore) return maxRating;

            // 20 ‡¶•‡ßá‡¶ï‡ßá 100 ‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶∏‡ßç‡¶ï‡ßã‡¶∞‡¶ï‡ßá 1.0 ‡¶•‡ßá‡¶ï‡ßá 5.0 ‡¶è ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ï‡¶∞‡¶æ
            // 20 (1 star) ‡¶•‡ßá‡¶ï‡ßá 100 (5 stars) ‡¶è‡¶∞ ‡¶∞‡ßá‡¶û‡ßç‡¶ú
            const normalizedScore = (score - 20) / (maxScore - 20); // 0 ‡¶•‡ßá‡¶ï‡ßá 1.0
            let rating = normalizedScore * (maxRating - minRating) + minRating;

            // 0.5 ‡¶∏‡ßç‡¶ü‡ßá‡¶™‡ßá ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡¶ï‡¶∞‡¶æ
            rating = Math.round(rating * 2) / 2;
            
            return parseFloat(rating.toFixed(1));
        }

        /**
         * ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶õ‡ßã‡¶ü ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶ï‡¶® HTML ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá‡•§
         * @param {number} score - ‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶æ‡¶∏‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø‡¶§‡¶æ ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ (‡ß¶.‡ß¶ ‡¶•‡ßá‡¶ï‡ßá ‡ß´.‡ß¶)‡•§
         * @returns {string} - ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶ï‡¶® HTML ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Ç‡•§
         */
        const renderSmallStarRating = (score) => {
            const roundedScore = Math.round(score * 2) / 2; 
            let html = '';
            for (let i = 1; i <= 5; i++) {
                if (roundedScore >= i) {
                    html += `<i class="fas fa-star small-star filled-star"></i>`;
                } else if (roundedScore === i - 0.5) {
                    html += `<i class="fas fa-star-half-alt small-star filled-star"></i>`;
                } else {
                    html += `<i class="far fa-star small-star filled-star empty-star"></i>`;
                }
            }
            return html;
        };
        
        // ======================================================================
        // üî• ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
        // ======================================================================
        document.addEventListener('DOMContentLoaded', () => {
            const leaderboardList = document.getElementById('leaderboard-list');
            
            // RTDB ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶®‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá
            const usersRef = ref(rtdb, "users");
            
            onValue(usersRef, (snapshot) => {
                const usersData = snapshot.val();
                leaderboardList.innerHTML = ''; // ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
                
                if (!usersData) {
                    leaderboardList.innerHTML = '<li class="text-center py-6 text-gray-500 text-lg">‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§</li>';
                    return;
                }

                // ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ö‡¶¨‡¶ú‡ßá‡¶ï‡ßç‡¶ü ‡¶•‡ßá‡¶ï‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶∞‡ßá‡¶§‡ßá ‡¶∞‡ßÇ‡¶™‡¶æ‡¶®‡ßç‡¶§‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º ‡¶Æ‡¶æ‡¶® ‡¶ó‡¶£‡¶®‡¶æ ‡¶ï‡¶∞‡¶æ
                let calculatedUsers = Object.keys(usersData).map(key => {
                    const user = usersData[key];
                    
                    // üî• ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®: trustScore ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶ú ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá (trustScore ‡¶¨‡¶æ trustScore, ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶ï‡¶ü‡¶ø ‡¶•‡¶æ‡¶ï‡¶≤‡ßá‡¶á ‡¶π‡¶¨‡ßá)
                    const rawtrustScore = user.trustScore || user.trustScore || 0; 

                    // üî• ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®: raw trustScore ‡¶ï‡ßá ‡ß´-‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç‡ßü‡ßá ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ï‡¶∞‡¶æ
                    const fiveStarRating = mapScoreToFiveStarRating(rawtrustScore); 
                    
                    const tasksCompleted = user.tasksCompleted || 0; 
                    const totalTasks = tasksCompleted + (user.tasksRejected || 0);
                    const successRate = totalTasks > 0 ? tasksCompleted / totalTasks : 0;

                    return { 
                        id: key, 
                        ...user, 
                        totalTasks, 
                        successRate,
                        fiveStarRating: fiveStarRating, 
                        rawtrustScore: rawtrustScore
                    };
                }).filter(user => user.rawtrustScore > 0); // ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶Ø‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ ‡ß¶ ‡¶è‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø, ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶≤‡ßã

                
                // --- ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶∏‡¶∞‡ßç‡¶ü‡¶ø‡¶Ç ‡¶≤‡¶ú‡¶ø‡¶ï (‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü) ---
                calculatedUsers.sort((a, b) => {
                    // üî• ‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶∏‡¶∞‡ßç‡¶ü: ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ rawtrustScore ‡¶è‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá (Descending - ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶∞‡ßç‡¶¨‡¶®‡¶ø‡¶Æ‡ßç‡¶®)
                    if (b.rawtrustScore !== a.rawtrustScore) {
                        return b.rawtrustScore - a.rawtrustScore;
                    }

                    // ‡¶ü‡¶æ‡¶á-‡¶¨‡ßç‡¶∞‡ßá‡¶ï‡¶æ‡¶∞ ‡ßß: ‡¶Æ‡ßã‡¶ü ‡¶ï‡¶æ‡¶ú (‡¶Ø‡¶¶‡¶ø ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ ‡¶∏‡¶Æ‡¶æ‡¶® ‡¶π‡¶Ø‡¶º)
                    if (b.totalTasks !== a.totalTasks) {
                        return b.totalTasks - a.totalTasks;
                    }
                    
                    // ‡¶ü‡¶æ‡¶á-‡¶¨‡ßç‡¶∞‡ßá‡¶ï‡¶æ‡¶∞ ‡ß®: ‡¶∏‡¶´‡¶≤‡¶§‡¶æ‡¶∞ ‡¶π‡¶æ‡¶∞
                    return b.successRate - a.successRate;
                });

                let rank = 1;
                
                // ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶∂‡ßÄ‡¶∞‡ßç‡¶∑ ‡ßß‡ß¶ ‡¶ú‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶ï‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
                const topTenUsers = calculatedUsers.slice(0, 10); 

                topTenUsers.forEach((user) => {
                    const successRatePercentage = (user.successRate * 100).toFixed(1);
                    const totalTasks = user.totalTasks;
                    const ratingHtml = renderSmallStarRating(user.fiveStarRating); 

                    const listItem = document.createElement('li');
                    
                    let rankClass = '';
                    let rankIcon = `<span class="w-8 h-8 flex items-center justify-center text-lg font-bold">${rank}</span>`;

                    if (rank === 1) {
                        rankClass = 'first';
                        rankIcon = '<i class="fas fa-medal medal-icon drop-shadow-md" style="color: #FFD700;"></i>';
                    } else if (rank === 2) {
                        rankClass = 'second';
                        rankIcon = '<i class="fas fa-medal medal-icon text-gray-600"></i>';
                    } else if (rank === 3) {
                        rankClass = 'third';
                        rankIcon = '<i class="fas fa-medal medal-icon text-orange-600"></i>';
                    }
                    
                    
                    listItem.className = `leaderboard-item ${rankClass} flex items-center justify-between font-bold border-b border-gray-100 last:border-b-0`;
                    listItem.innerHTML = `
                        <div class="flex items-center">
                            ${rankIcon}
                            <div class="ml-2">
                                <span class="text-base md:text-lg font-bold ${rank <= 3 ? 'text-gray-800' : 'text-gray-700'}">${user.facebookName || '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ'}</span>
                                <!-- üî• ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®: Raw Score ‡¶∏‡¶π ‡ß´-‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã -->
                                <div class="small-rating-bar mt-1">
                                    ${ratingHtml}
                                    <span class="text-xs text-gray-600 ml-1">
                                        (${user.fiveStarRating.toFixed(1)} ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ / ${user.rawtrustScore.toLocaleString('bn-BD')} ‡¶∏‡ßç‡¶ï‡ßã‡¶∞)
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="text-right flex flex-col items-end">
                            <!-- ‡¶Æ‡ßã‡¶ü ‡¶ï‡¶æ‡¶ú ‡¶ì ‡¶∏‡¶´‡¶≤‡¶§‡¶æ‡¶∞ ‡¶π‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶ö‡ßç‡¶õ‡ßá, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶∞‡ßç‡¶Ø‡¶æ‡¶ô‡ßç‡¶ï‡¶ø‡¶Ç ‡¶è ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶®‡¶æ -->
                            <span class="text-lg md:text-xl font-extrabold text-blue-600 leading-tight">${totalTasks.toLocaleString('bn-BD')} ‡¶Æ‡ßã‡¶ü ‡¶ï‡¶æ‡¶ú</span>
                            <span class="text-sm font-medium text-gray-600 leading-tight mt-1">‡¶∏‡¶´‡¶≤‡¶§‡¶æ‡¶∞ ‡¶π‡¶æ‡¶∞: ${successRatePercentage}%</span>
                        </div>
                    `;
                    leaderboardList.appendChild(listItem);
                    rank++;
                });
                
                if (calculatedUsers.length === 0) {
                     leaderboardList.innerHTML = '<li class="text-center py-6 text-gray-500 text-lg">‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡¶æ‡¶ú ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßá‡¶®‡¶ø‡•§</li>';
                }
            });
        });
    </script>
</body>
</html>

